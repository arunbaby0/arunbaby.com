<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.26.2 by Michael Rose
  Copyright 2013-2024 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->

<html lang="en-US" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Custom Language Modeling - Arun Baby</title>
<meta name="description" content="“The model knows ‘Apple’ the fruit. It needs to learn ‘Apple’ the stock ticker.”">


  <meta name="author" content="Arun Baby">
  
  <meta property="article:author" content="Arun Baby">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Arun Baby">
<meta property="og:title" content="Custom Language Modeling">
<meta property="og:url" content="https://www.arunbaby.com/speech-tech/0050-custom-language-modeling/">


  <meta property="og:description" content="“The model knows ‘Apple’ the fruit. It needs to learn ‘Apple’ the stock ticker.”">



  <meta property="og:image" content="https://www.arunbaby.com/assets/images/profile-photo.png">



  <meta name="twitter:site" content="@arunbaby0">
  <meta name="twitter:title" content="Custom Language Modeling">
  <meta name="twitter:description" content="“The model knows ‘Apple’ the fruit. It needs to learn ‘Apple’ the stock ticker.”">
  <meta name="twitter:url" content="https://www.arunbaby.com/speech-tech/0050-custom-language-modeling/">

  
    <meta name="twitter:card" content="summary">
    
      <meta name="twitter:image" content="https://www.arunbaby.com/assets/images/profile-photo.png">
    
  

  



  <meta property="article:published_time" content="2025-12-22T11:01:30+05:30">





  

  


<link rel="canonical" href="https://www.arunbaby.com/speech-tech/0050-custom-language-modeling/">












<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Arun Baby Feed">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
  
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single" dir="ltr">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
           
          <span class="site-subtitle">Arun Baby</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a
                href="/about/"
                
                
              >About</a>
            </li><li class="masthead__menu-item">
              <a
                href="/dsa/"
                
                
              >DSA</a>
            </li><li class="masthead__menu-item">
              <a
                href="/ml-system-design/"
                
                
              >ML Systems</a>
            </li><li class="masthead__menu-item">
              <a
                href="/speech-tech/"
                
                
              >Speech Tech</a>
            </li><li class="masthead__menu-item">
              <a
                href="/ai-agents/"
                
                
              >AI Agents</a>
            </li><li class="masthead__menu-item">
              <a
                href="/publications/"
                
                
              >Publications</a>
            </li><li class="masthead__menu-item">
              <a
                href="/statuses/"
                
                
              >Statuses</a>
            </li><li class="masthead__menu-item">
              <a
                href="/contact/"
                
                
              >Contact</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main" class="no-author-sidebar">
  
  <div class="sidebar sticky">
  
  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Custom Language Modeling">
    <meta itemprop="description" content="“The model knows ‘Apple’ the fruit. It needs to learn ‘Apple’ the stock ticker.”">
    <meta itemprop="datePublished" content="2025-12-22T11:01:30+05:30">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">
            <a href="https://www.arunbaby.com/speech-tech/0050-custom-language-modeling/" itemprop="url">Custom Language Modeling
</a>
          </h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          3 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu"><li><a href="#1-introduction-the-unique-name-problem">1. Introduction: The “Unique Name” Problem</a></li><li><a href="#2-how-asr-works-simplified">2. How ASR Works (Simplified)</a></li><li><a href="#3-techniques-for-customization">3. Techniques for Customization</a><ul><li><a href="#31-vocabulary-expansion-the-word-list">3.1 Vocabulary Expansion (The “Word List”)</a></li><li><a href="#32-corpus-fine-tuning">3.2 Corpus Fine-Tuning</a></li><li><a href="#33-contextual-asr-real-time-hints">3.3 Contextual ASR (Real-Time hints)</a></li></ul></li><li><a href="#4-architecture-implementation">4. Architecture Implementation</a></li><li><a href="#5-metrics-wer-isnt-enough">5. Metrics: WER isn’t enough</a></li><li><a href="#6-summary">6. Summary</a></li></ul>
            </nav>
          </aside>
        
        <p><strong>“The model knows ‘Apple’ the fruit. It needs to learn ‘Apple’ the stock ticker.”</strong></p>

<h2 id="1-introduction-the-unique-name-problem">1. Introduction: The “Unique Name” Problem</h2>

<p>You deploy a generic ASR model for a medical clinic.
Doctor says: “Patient needs 50mg of <strong>Xarelto</strong>.”
ASR output: “Patient needs 50mg of <strong>the rel toe</strong>.”</p>

<p>The model isn’t “bad”. It just mapped the sounds to the most probable English words it knows. “Xarelto” is rare. “The rel toe” is common.
To fix this without retraining the massive acoustic model ($1M cost), we use <strong>Custom Language Models</strong> (CLM) or <strong>Contextual Biasing</strong>.</p>

<hr />

<h2 id="2-how-asr-works-simplified">2. How ASR Works (Simplified)</h2>

<p>ASR is mathematically: <code class="language-plaintext highlighter-rouge">P(Text | Audio)</code>.
Using Bayes theorem, this splits into:
<code class="language-plaintext highlighter-rouge">P(Audio | Text) * P(Text)</code></p>

<ol>
  <li><strong>Acoustic Model <code class="language-plaintext highlighter-rouge">P(Audio | Text)</code></strong>: “Does this sound match these phonemes?”</li>
  <li><strong>Language Model <code class="language-plaintext highlighter-rouge">P(Text)</code></strong>: “Is this a valid sequence of words?”</li>
</ol>

<p>The generic LM says <code class="language-plaintext highlighter-rouge">P("the rel toe") &gt;&gt; P("Xarelto")</code>.
We need to hack the LM to say: “In <em>this</em> clinic, <code class="language-plaintext highlighter-rouge">P("Xarelto")</code> is very high.”</p>

<hr />

<h2 id="3-techniques-for-customization">3. Techniques for Customization</h2>

<h3 id="31-vocabulary-expansion-the-word-list">3.1 Vocabulary Expansion (The “Word List”)</h3>
<p>The simplest customization. You upload a list of 500 domain-specific terms (Product names, employee names).
The ASR engine compiles a small, dynamic graph of these words and “boosts” their probability scores during the beam search decoding.</p>

<p><strong>Pros</strong>: Fast, easy API update.
<strong>Cons</strong>: Can over-trigger. If you add “Cash”, the model might hear “Cash” every time someone says “Catch”.</p>

<h3 id="32-corpus-fine-tuning">3.2 Corpus Fine-Tuning</h3>
<p>You upload 10,000 text documents (Medical Journals, Legal Briefs) from your domain.
You train a <em>text-only</em> Language Model (unsupervised) on this data.
You <strong>interpolate</strong> this small, specific LM with the huge, generic LM.
<code class="language-plaintext highlighter-rouge">Final_Score = 0.8 * Generic_LM + 0.2 * Custom_LM</code>.</p>

<p><strong>Pros</strong>: Captures grammar and context (“Patient presents with…”), not just names.
<strong>Cons</strong>: Slower to deploy.</p>

<h3 id="33-contextual-asr-real-time-hints">3.3 Contextual ASR (Real-Time hints)</h3>
<p>This is the cutting edge (used by Siri/Alexa).
When you open your “Contacts” app, the phone sends your contact list to the ASR engine <em>for that session only</em>.
The ASR temporarily boosts <code class="language-plaintext highlighter-rouge">P("Arun")</code> because “Arun” is in your contacts.
Five minutes later, if you say “Arun” while in the Maps app, it might fail if it’s not a common location.</p>

<p>This “Contextual Biasing” is dynamic and fleeting.</p>

<hr />

<h2 id="4-architecture-implementation">4. Architecture Implementation</h2>

<p>How do we actually implement this with modern tools like <strong>Whisper</strong>?
Whisper is an “End-to-End” model (Acoustic + LM combined). It’s hard to inject an external LM.</p>

<p><strong>Option A: Prompt Engineering</strong>
Whisper accepts a <code class="language-plaintext highlighter-rouge">prompt</code> string.
If we pass <code class="language-plaintext highlighter-rouge">prompt="Xarelto, Ibuprofen, Tylenol"</code>, the Transformer’s attention mechanism attends to those words.
When it hears ambiguity, it “copies” from the prompt.
<em>This works surprisingly well!</em></p>

<p><strong>Option B: Shallow Fusion</strong>
We run an external n-gram LM alongside Whisper’s beam search.
At every decoding step, we check the external LM.
<code class="language-plaintext highlighter-rouge">Score = Whisper_Logit + Beta * External_LM_Logit</code>.</p>

<hr />

<h2 id="5-metrics-wer-isnt-enough">5. Metrics: WER isn’t enough</h2>

<p>If you just measure standard Word Error Rate (WER) on “The cat sat on the mat”, your medical model looks fine.
We need <strong>Entity-WER</strong>.</p>
<ul>
  <li>Accuracy on specific “entities” (Drug names, Locations).</li>
  <li>Finding “Xarelto” correctly is worth 100x more than missing “the”.</li>
</ul>

<hr />

<h2 id="6-summary">6. Summary</h2>

<p>Custom Language Modeling is the bridge between a “Demo” and a “Product”.
A Demo works on generic YouTube videos.
A Product works for <em>your</em> users, speaking <em>your</em> jargon, in <em>your</em> noise conditions.
It allows us to “teach” the AI new vocabulary instantly, without the massive cost of teaching it new sounds.</p>

<hr />

<p><strong>Originally published at:</strong> <a href="https://www.arunbaby.com/speech-tech/0050-custom-language-modeling/">arunbaby.com/speech-tech/0050-custom-language-modeling</a></p>

<p><em>If you found this helpful, consider sharing it with others who might benefit.</em></p>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#asr" class="page__taxonomy-item p-category" rel="tag">asr</a><span class="sep">, </span>
    
      <a href="/tags/#biasing" class="page__taxonomy-item p-category" rel="tag">biasing</a><span class="sep">, </span>
    
      <a href="/tags/#contextual-asr" class="page__taxonomy-item p-category" rel="tag">contextual-asr</a><span class="sep">, </span>
    
      <a href="/tags/#language-model" class="page__taxonomy-item p-category" rel="tag">language-model</a><span class="sep">, </span>
    
      <a href="/tags/#production" class="page__taxonomy-item p-category" rel="tag">production</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#speech-tech" class="page__taxonomy-item p-category" rel="tag">speech-tech</a>
    
    </span>
  </p>


        
      </footer>

      <div class="page__related page__related--full">
  <h2 class="page__related-title">Related across topics</h2>
  <style>
    /* Make section span full content width and use 2 equal columns */
    .page__related--full { float: inline-start; width: 100%; padding: 0; }
    .cross-related-grid { display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 2rem; }
    @media (max-width: 768px) { .cross-related-grid { grid-template-columns: 1fr; } }
    /* Ensure archive cards stretch nicely in the grid */
    .cross-related-grid .list__item, .cross-related-grid .grid__item { width: auto; float: none; margin: 0; }
  </style>
  <div class="cross-related-grid">
    



<div class="list__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/dsa/0050-alien-dictionary/" rel="permalink">Alien Dictionary
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          5 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">“If ‘apple’ comes before ‘banana’ but ‘bat’ comes before ‘arc’, what is the alphabet?”
</p>
  </article>
</div>




<div class="list__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/ml-system-design/0050-character-level-language-models/" rel="permalink">Character-Level Language Models
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          4 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">“Before machines could write essays, they had to learn to spell.”
</p>
  </article>
</div>




<div class="list__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/ai-agents/0050-building-domain-specific-agents/" rel="permalink">Building Domain-Specific Agents
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          3 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">“Don’t build a generalist. Build a specialist.”
</p>
  </article>
</div>

  </div>
</div>

      <section class="page__share">
  <h4 class="page__share-title">Share on</h4>

  <a href="https://twitter.com/intent/tweet?via=arunbaby0&text=Custom+Language+Modeling%20https%3A%2F%2Fwww.arunbaby.com%2Fspeech-tech%2F0050-custom-language-modeling%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.arunbaby.com%2Fspeech-tech%2F0050-custom-language-modeling%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.arunbaby.com/speech-tech/0050-custom-language-modeling/" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/speech-tech/0049-speech-pipeline-dependencies/" class="pagination--pager" title="Speech Pipeline Dependencies">Previous</a>
    
    
      <a href="#" class="pagination--pager disabled">Next</a>
    
  </nav>


    </div>

    
  </article>

  
  
</div>

      
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://twitter.com/arunbaby0" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://github.com/arunbaby0" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
          <li><a href="https://www.linkedin.com/in/arunbaby0/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
        
      
        
          <li><a href="https://scholar.google.co.in/citations?user=6fSYWhkAAAAJ" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-graduation-cap" aria-hidden="true"></i> Google Scholar</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 1990 - 2143 <a href="https://www.arunbaby.com">Arun Baby</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0JRJPEC9SS"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-0JRJPEC9SS', { 'anonymize_ip': false});
</script>








  </body>
</html>
