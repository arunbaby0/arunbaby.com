<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.26.2 by Michael Rose
  Copyright 2013-2024 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->

<html lang="en-US" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Word Search II - Arun Baby</title>
<meta name="description" content="“Find all words hiding in a grid—with a Trie to light the way.”">


  <meta name="author" content="Arun Baby">
  
  <meta property="article:author" content="Arun Baby">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Arun Baby">
<meta property="og:title" content="Word Search II">
<meta property="og:url" content="https://www.arunbaby.com/dsa/0048-word-search-ii/">


  <meta property="og:description" content="“Find all words hiding in a grid—with a Trie to light the way.”">



  <meta property="og:image" content="https://www.arunbaby.com/assets/images/profile-photo.png">



  <meta name="twitter:site" content="@arunbaby0">
  <meta name="twitter:title" content="Word Search II">
  <meta name="twitter:description" content="“Find all words hiding in a grid—with a Trie to light the way.”">
  <meta name="twitter:url" content="https://www.arunbaby.com/dsa/0048-word-search-ii/">

  
    <meta name="twitter:card" content="summary">
    
      <meta name="twitter:image" content="https://www.arunbaby.com/assets/images/profile-photo.png">
    
  

  



  <meta property="article:published_time" content="2025-12-21T22:46:31+05:30">





  

  


<link rel="canonical" href="https://www.arunbaby.com/dsa/0048-word-search-ii/">












<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Arun Baby Feed">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
  
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single" dir="ltr">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
           
          <span class="site-subtitle">Arun Baby</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a
                href="/about/"
                
                
              >About</a>
            </li><li class="masthead__menu-item">
              <a
                href="/dsa/"
                
                
              >DSA</a>
            </li><li class="masthead__menu-item">
              <a
                href="/ml-system-design/"
                
                
              >ML Systems</a>
            </li><li class="masthead__menu-item">
              <a
                href="/speech-tech/"
                
                
              >Speech Tech</a>
            </li><li class="masthead__menu-item">
              <a
                href="/ai-agents/"
                
                
              >AI Agents</a>
            </li><li class="masthead__menu-item">
              <a
                href="/publications/"
                
                
              >Publications</a>
            </li><li class="masthead__menu-item">
              <a
                href="/statuses/"
                
                
              >Statuses</a>
            </li><li class="masthead__menu-item">
              <a
                href="/contact/"
                
                
              >Contact</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main" class="no-author-sidebar">
  
  <div class="sidebar sticky">
  
  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Word Search II">
    <meta itemprop="description" content="“Find all words hiding in a grid—with a Trie to light the way.”">
    <meta itemprop="datePublished" content="2025-12-21T22:46:31+05:30">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">
            <a href="https://www.arunbaby.com/dsa/0048-word-search-ii/" itemprop="url">Word Search II
</a>
          </h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          6 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu"><li><a href="#1-problem-statement">1. Problem Statement</a></li><li><a href="#2-understanding-the-problem">2. Understanding the Problem</a><ul><li><a href="#key-insight-trie-for-prefix-matching">Key Insight: Trie for Prefix Matching</a></li></ul></li><li><a href="#3-approach-trie--dfs-backtracking">3. Approach: Trie + DFS Backtracking</a></li><li><a href="#4-detailed-walkthrough">4. Detailed Walkthrough</a></li><li><a href="#5-optimizations">5. Optimizations</a><ul><li><a href="#51-trie-pruning">5.1 Trie Pruning</a></li><li><a href="#52-early-termination">5.2 Early Termination</a></li><li><a href="#53-board-character-frequency-check">5.3 Board Character Frequency Check</a></li></ul></li><li><a href="#6-alternative-iterative-with-stack">6. Alternative: Iterative with Stack</a></li><li><a href="#7-complexity-analysis">7. Complexity Analysis</a></li><li><a href="#8-common-mistakes">8. Common Mistakes</a></li><li><a href="#9-testing">9. Testing</a></li><li><a href="#10-connection-to-trie-based-search-in-ml">10. Connection to Trie-based Search in ML</a></li></ul>
            </nav>
          </aside>
        
        <p><strong>“Find all words hiding in a grid—with a Trie to light the way.”</strong></p>

<h2 id="1-problem-statement">1. Problem Statement</h2>

<p>Given an <code class="language-plaintext highlighter-rouge">m x n</code> board of characters and a list of strings <code class="language-plaintext highlighter-rouge">words</code>, return all words on the board. Each word must be constructed from letters of sequentially adjacent cells (horizontal or vertical neighbors). The same cell may not be used more than once in a word.</p>

<p><strong>Example:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>board = [
  ['o','a','a','n'],
  ['e','t','a','e'],
  ['i','h','k','r'],
  ['i','f','l','v']
]
words = ["oath","pea","eat","rain"]

Output: ["eat","oath"]
</code></pre></div></div>

<p><strong>Constraints:</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">m, n ≤ 12</code></li>
  <li><code class="language-plaintext highlighter-rouge">1 ≤ words.length ≤ 3 × 10^4</code></li>
  <li><code class="language-plaintext highlighter-rouge">1 ≤ words[i].length ≤ 10</code></li>
</ul>

<h2 id="2-understanding-the-problem">2. Understanding the Problem</h2>

<p>This is Word Search I on steroids—instead of checking one word, we check thousands. The naive approach would apply Word Search I for each word: O(words × M × N × 4^L). With 30K words, this is too slow.</p>

<h3 id="key-insight-trie-for-prefix-matching">Key Insight: Trie for Prefix Matching</h3>

<p>Build all words into a Trie, then DFS through the board. At each cell, check if the current path is a prefix in the Trie. If not, prune immediately.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Words: ["oath", "oat", "pea"]

Trie:
       root
      /    \
     o      p
     |      |
     a      e
     |      |
     t*     a*
     |
     h*
</code></pre></div></div>

<h2 id="3-approach-trie--dfs-backtracking">3. Approach: Trie + DFS Backtracking</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">typing</span> <span class="kn">import</span> <span class="n">List</span>

<span class="k">class</span> <span class="nc">TrieNode</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">children</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">word</span> <span class="o">=</span> <span class="bp">None</span>  <span class="c1"># Store full word at end
</span>

<span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">findWords</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">board</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">words</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sh">"""</span><span class="s">
        Find all words from list that exist in the board.
        
        Approach:
        1. Build Trie from all words
        2. DFS from each cell, following Trie paths
        3. Prune when no prefix match
        
        Time: O(M×N×4^L) worst case, but Trie pruning helps significantly
        Space: O(total characters in words) for Trie
        </span><span class="sh">"""</span>
        <span class="c1"># Build Trie
</span>        <span class="n">root</span> <span class="o">=</span> <span class="nc">TrieNode</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">root</span>
            <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">word</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">char</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">node</span><span class="p">.</span><span class="n">children</span><span class="p">:</span>
                    <span class="n">node</span><span class="p">.</span><span class="n">children</span><span class="p">[</span><span class="n">char</span><span class="p">]</span> <span class="o">=</span> <span class="nc">TrieNode</span><span class="p">()</span>
                <span class="n">node</span> <span class="o">=</span> <span class="n">node</span><span class="p">.</span><span class="n">children</span><span class="p">[</span><span class="n">char</span><span class="p">]</span>
            <span class="n">node</span><span class="p">.</span><span class="n">word</span> <span class="o">=</span> <span class="n">word</span>
        
        <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">board</span><span class="p">),</span> <span class="nf">len</span><span class="p">(</span><span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">def</span> <span class="nf">dfs</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
            <span class="sh">"""</span><span class="s">DFS with Trie guidance.</span><span class="sh">"""</span>
            <span class="n">char</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span>
            
            <span class="c1"># Check if current char in Trie path
</span>            <span class="k">if</span> <span class="n">char</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">node</span><span class="p">.</span><span class="n">children</span><span class="p">:</span>
                <span class="k">return</span>
            
            <span class="n">next_node</span> <span class="o">=</span> <span class="n">node</span><span class="p">.</span><span class="n">children</span><span class="p">[</span><span class="n">char</span><span class="p">]</span>
            
            <span class="c1"># Found a word?
</span>            <span class="k">if</span> <span class="n">next_node</span><span class="p">.</span><span class="n">word</span><span class="p">:</span>
                <span class="n">result</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">next_node</span><span class="p">.</span><span class="n">word</span><span class="p">)</span>
                <span class="n">next_node</span><span class="p">.</span><span class="n">word</span> <span class="o">=</span> <span class="bp">None</span>  <span class="c1"># Avoid duplicates
</span>            
            <span class="c1"># Mark visited
</span>            <span class="n">board</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="sh">'</span><span class="s">#</span><span class="sh">'</span>
            
            <span class="c1"># Explore neighbors
</span>            <span class="k">for</span> <span class="n">dr</span><span class="p">,</span> <span class="n">dc</span> <span class="ow">in</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]:</span>
                <span class="n">nr</span><span class="p">,</span> <span class="n">nc</span> <span class="o">=</span> <span class="n">row</span> <span class="o">+</span> <span class="n">dr</span><span class="p">,</span> <span class="n">col</span> <span class="o">+</span> <span class="n">dc</span>
                <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">nr</span> <span class="o">&lt;</span> <span class="n">m</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">nc</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="n">nr</span><span class="p">][</span><span class="n">nc</span><span class="p">]</span> <span class="o">!=</span> <span class="sh">'</span><span class="s">#</span><span class="sh">'</span><span class="p">:</span>
                    <span class="nf">dfs</span><span class="p">(</span><span class="n">nr</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="n">next_node</span><span class="p">)</span>
            
            <span class="c1"># Restore
</span>            <span class="n">board</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">char</span>
            
            <span class="c1"># Optimization: remove leaf nodes with no words
</span>            <span class="k">if</span> <span class="ow">not</span> <span class="n">next_node</span><span class="p">.</span><span class="n">children</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">next_node</span><span class="p">.</span><span class="n">word</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">node</span><span class="p">.</span><span class="n">children</span><span class="p">[</span><span class="n">char</span><span class="p">]</span>
        
        <span class="c1"># Start DFS from each cell
</span>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="nf">dfs</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">root</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">result</span>
</code></pre></div></div>

<h2 id="4-detailed-walkthrough">4. Detailed Walkthrough</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>board = [['o','a','a','n'],
         ['e','t','a','e'],
         ['i','h','k','r'],
         ['i','f','l','v']]

words = ["oath","pea","eat","rain"]

Trie after building:
root → o → a → t → h (word: "oath")
     |
     → p → e → a (word: "pea")
     |
     → e → a → t (word: "eat")
     |
     → r → a → i → n (word: "rain")

DFS from (0,0) = 'o':
- 'o' in Trie? Yes
- Neighbors: (0,1)='a', (1,0)='e'
- DFS (0,1) = 'a': 'a' after 'o'? Yes
  - DFS (0,2) = 'a': 'a' after 'oa'? No, prune
  - DFS (1,1) = 't': 't' after 'oa'? Yes
    - Found "oat"? No word marker
    - DFS (2,1) = 'h': 'h' after 'oat'? Yes
      - Found "oath"! Add to result
      
DFS from (1,1) = 't' eventually finds "eat": e(1,0) → a(0,1) → t(1,1)
</code></pre></div></div>

<h2 id="5-optimizations">5. Optimizations</h2>

<h3 id="51-trie-pruning">5.1 Trie Pruning</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># After finding a word, prune empty branches
</span><span class="k">if</span> <span class="ow">not</span> <span class="n">next_node</span><span class="p">.</span><span class="n">children</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">next_node</span><span class="p">.</span><span class="n">word</span><span class="p">:</span>
    <span class="k">del</span> <span class="n">node</span><span class="p">.</span><span class="n">children</span><span class="p">[</span><span class="n">char</span><span class="p">]</span>
</code></pre></div></div>

<p>This is crucial—as we find words, we remove them from the Trie, reducing future search space.</p>

<h3 id="52-early-termination">5.2 Early Termination</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Before starting DFS, check if any words remain
</span><span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="p">.</span><span class="n">children</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></div>

<h3 id="53-board-character-frequency-check">5.3 Board Character Frequency Check</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">collections</span> <span class="kn">import</span> <span class="n">Counter</span>

<span class="k">def</span> <span class="nf">can_form_word</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">board_chars</span><span class="p">):</span>
    <span class="n">word_count</span> <span class="o">=</span> <span class="nc">Counter</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
    <span class="k">return</span> <span class="nf">all</span><span class="p">(</span><span class="n">board_chars</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">word_count</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">word_count</span><span class="p">)</span>

<span class="c1"># Filter words that can't possibly be formed
</span><span class="n">board_chars</span> <span class="o">=</span> <span class="nc">Counter</span><span class="p">(</span><span class="n">c</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">board</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">row</span><span class="p">)</span>
<span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">words</span> <span class="k">if</span> <span class="nf">can_form_word</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">board_chars</span><span class="p">)]</span>
</code></pre></div></div>

<h2 id="6-alternative-iterative-with-stack">6. Alternative: Iterative with Stack</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">findWords_iterative</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="n">words</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Iterative version using explicit stack.</span><span class="sh">"""</span>
    <span class="n">root</span> <span class="o">=</span> <span class="nf">build_trie</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
    <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">board</span><span class="p">),</span> <span class="nf">len</span><span class="p">(</span><span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="c1"># Stack: (row, col, node, path, visited)
</span>            <span class="n">stack</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="sh">""</span><span class="p">,</span> <span class="nf">set</span><span class="p">())]</span>
            
            <span class="k">while</span> <span class="n">stack</span><span class="p">:</span>
                <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">visited</span> <span class="o">=</span> <span class="n">stack</span><span class="p">.</span><span class="nf">pop</span><span class="p">()</span>
                
                <span class="nf">if </span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
                    <span class="k">continue</span>
                
                <span class="n">char</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">char</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">node</span><span class="p">.</span><span class="n">children</span><span class="p">:</span>
                    <span class="k">continue</span>
                
                <span class="n">next_node</span> <span class="o">=</span> <span class="n">node</span><span class="p">.</span><span class="n">children</span><span class="p">[</span><span class="n">char</span><span class="p">]</span>
                <span class="n">new_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="n">char</span>
                <span class="n">new_visited</span> <span class="o">=</span> <span class="n">visited</span> <span class="o">|</span> <span class="p">{(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)}</span>
                
                <span class="k">if</span> <span class="n">next_node</span><span class="p">.</span><span class="n">word</span><span class="p">:</span>
                    <span class="n">result</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">next_node</span><span class="p">.</span><span class="n">word</span><span class="p">)</span>
                    <span class="n">next_node</span><span class="p">.</span><span class="n">word</span> <span class="o">=</span> <span class="bp">None</span>
                
                <span class="k">for</span> <span class="n">dr</span><span class="p">,</span> <span class="n">dc</span> <span class="ow">in</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)]:</span>
                    <span class="n">nr</span><span class="p">,</span> <span class="n">nc</span> <span class="o">=</span> <span class="n">row</span> <span class="o">+</span> <span class="n">dr</span><span class="p">,</span> <span class="n">col</span> <span class="o">+</span> <span class="n">dc</span>
                    <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">nr</span> <span class="o">&lt;</span> <span class="n">m</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">nc</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
                        <span class="n">stack</span><span class="p">.</span><span class="nf">append</span><span class="p">((</span><span class="n">nr</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="n">next_node</span><span class="p">,</span> <span class="n">new_path</span><span class="p">,</span> <span class="n">new_visited</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></div>

<h2 id="7-complexity-analysis">7. Complexity Analysis</h2>

<p><strong>Time:</strong> O(M × N × 4^L)</p>
<ul>
  <li>M × N starting positions</li>
  <li>4^L possible paths (4 directions, L = max word length)</li>
  <li>Trie pruning typically reduces this significantly</li>
</ul>

<p><strong>Space:</strong> O(Total characters in words)</p>
<ul>
  <li>Trie storage</li>
  <li>O(L) recursion depth</li>
</ul>

<h2 id="8-common-mistakes">8. Common Mistakes</h2>

<ol>
  <li><strong>Forgetting to unmark visited cells</strong> during backtrack</li>
  <li><strong>Not handling duplicates</strong> - same word found via different paths</li>
  <li><strong>Modifying board permanently</strong> - always restore after DFS</li>
  <li><strong>Not pruning empty Trie branches</strong> - significant performance loss</li>
</ol>

<h2 id="9-testing">9. Testing</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">test_word_search</span><span class="p">():</span>
    <span class="n">s</span> <span class="o">=</span> <span class="nc">Solution</span><span class="p">()</span>
    
    <span class="c1"># Basic test
</span>    <span class="n">board1</span> <span class="o">=</span> <span class="p">[[</span><span class="sh">'</span><span class="s">o</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">n</span><span class="sh">'</span><span class="p">],[</span><span class="sh">'</span><span class="s">e</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">t</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">e</span><span class="sh">'</span><span class="p">],[</span><span class="sh">'</span><span class="s">i</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">h</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">k</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">r</span><span class="sh">'</span><span class="p">],[</span><span class="sh">'</span><span class="s">i</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">f</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">l</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">v</span><span class="sh">'</span><span class="p">]]</span>
    <span class="n">words1</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">oath</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">pea</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">eat</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">rain</span><span class="sh">"</span><span class="p">]</span>
    <span class="k">assert</span> <span class="nf">set</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="nf">findWords</span><span class="p">(</span><span class="n">board1</span><span class="p">,</span> <span class="n">words1</span><span class="p">))</span> <span class="o">==</span> <span class="p">{</span><span class="sh">"</span><span class="s">eat</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">oath</span><span class="sh">"</span><span class="p">}</span>
    
    <span class="c1"># Single cell
</span>    <span class="n">board2</span> <span class="o">=</span> <span class="p">[[</span><span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="p">]]</span>
    <span class="n">words2</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">a</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">ab</span><span class="sh">"</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">s</span><span class="p">.</span><span class="nf">findWords</span><span class="p">(</span><span class="n">board2</span><span class="p">,</span> <span class="n">words2</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="sh">"</span><span class="s">a</span><span class="sh">"</span><span class="p">]</span>
    
    <span class="c1"># No matches
</span>    <span class="n">board3</span> <span class="o">=</span> <span class="p">[[</span><span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">b</span><span class="sh">'</span><span class="p">],[</span><span class="sh">'</span><span class="s">c</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">d</span><span class="sh">'</span><span class="p">]]</span>
    <span class="n">words3</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">xyz</span><span class="sh">"</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">s</span><span class="p">.</span><span class="nf">findWords</span><span class="p">(</span><span class="n">board3</span><span class="p">,</span> <span class="n">words3</span><span class="p">)</span> <span class="o">==</span> <span class="p">[]</span>
    
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">All tests passed!</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="10-connection-to-trie-based-search-in-ml">10. Connection to Trie-based Search in ML</h2>

<p>Word Search II demonstrates Trie’s power for <strong>multi-pattern matching</strong>—a technique used extensively in:</p>

<ul>
  <li><strong>Autocomplete</strong>: Match user prefix against dictionary</li>
  <li><strong>Spell checkers</strong>: Find similar words</li>
  <li><strong>Phonetic search</strong>: Match speech transcripts</li>
</ul>

<p>The key insight—<strong>prune early using prefix structure</strong>—applies directly to trie-based search systems in ML.</p>

<hr />

<p><strong>Originally published at:</strong> <a href="https://www.arunbaby.com/dsa/0048-word-search-ii/">arunbaby.com/dsa/0048-word-search-ii</a></p>

<p><em>If you found this helpful, consider sharing it with others who might benefit.</em></p>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#backtracking" class="page__taxonomy-item p-category" rel="tag">backtracking</a><span class="sep">, </span>
    
      <a href="/tags/#dfs" class="page__taxonomy-item p-category" rel="tag">dfs</a><span class="sep">, </span>
    
      <a href="/tags/#matrix" class="page__taxonomy-item p-category" rel="tag">matrix</a><span class="sep">, </span>
    
      <a href="/tags/#prefix-tree" class="page__taxonomy-item p-category" rel="tag">prefix-tree</a><span class="sep">, </span>
    
      <a href="/tags/#trie" class="page__taxonomy-item p-category" rel="tag">trie</a><span class="sep">, </span>
    
      <a href="/tags/#word-search" class="page__taxonomy-item p-category" rel="tag">word-search</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#dsa" class="page__taxonomy-item p-category" rel="tag">dsa</a>
    
    </span>
  </p>


        
      </footer>

      <div class="page__related page__related--full">
  <h2 class="page__related-title">Related across topics</h2>
  <style>
    /* Make section span full content width and use 2 equal columns */
    .page__related--full { float: inline-start; width: 100%; padding: 0; }
    .cross-related-grid { display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 2rem; }
    @media (max-width: 768px) { .cross-related-grid { grid-template-columns: 1fr; } }
    /* Ensure archive cards stretch nicely in the grid */
    .cross-related-grid .list__item, .cross-related-grid .grid__item { width: auto; float: none; margin: 0; }
  </style>
  <div class="cross-related-grid">
    



<div class="list__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/ml-system-design/0048-trie-based-search/" rel="permalink">Trie-based Search Systems
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          6 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">“Every keystroke triggers a prefix lookup—Tries make it instant.”
</p>
  </article>
</div>




<div class="list__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/speech-tech/0048-phonetic-trie/" rel="permalink">Phonetic Trie for Speech Recognition
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          6 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">“Match sounds, not spellings—phonetic Tries unlock voice search.”
</p>
  </article>
</div>




<div class="list__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/ai-agents/0048-streaming-real-time-agents/" rel="permalink">Streaming and Real-Time Agents
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          5 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">“Users shouldn’t wait for the whole answer—stream it token by token.”
</p>
  </article>
</div>

  </div>
</div>

      <section class="page__share">
  <h4 class="page__share-title">Share on</h4>

  <a href="https://twitter.com/intent/tweet?via=arunbaby0&text=Word+Search+II%20https%3A%2F%2Fwww.arunbaby.com%2Fdsa%2F0048-word-search-ii%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.arunbaby.com%2Fdsa%2F0048-word-search-ii%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.arunbaby.com/dsa/0048-word-search-ii/" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/dsa/0047-serialize-deserialize-tree/" class="pagination--pager" title="Serialize and Deserialize Binary Tree">Previous</a>
    
    
      <a href="/dsa/0049-course-schedule/" class="pagination--pager" title="Course Schedule (Topological Sort)">Next</a>
    
  </nav>


    </div>

    
  </article>

  
  
</div>

      
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://twitter.com/arunbaby0" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://github.com/arunbaby0" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
          <li><a href="https://www.linkedin.com/in/arunbaby0/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
        
      
        
          <li><a href="https://scholar.google.co.in/citations?user=6fSYWhkAAAAJ" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-graduation-cap" aria-hidden="true"></i> Google Scholar</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 1990 - 2143 <a href="https://www.arunbaby.com">Arun Baby</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0JRJPEC9SS"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-0JRJPEC9SS', { 'anonymize_ip': false});
</script>








  </body>
</html>
