<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.26.2 by Michael Rose
  Copyright 2013-2024 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->

<html lang="en-US" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Rotate Image - Arun Baby</title>
<meta name="description" content="Learn to rotate a matrix in-place—the same pattern used for data augmentation, geometric transforms, and tensor manipulations in deep learning systems.">


  <meta name="author" content="Arun Baby">
  
  <meta property="article:author" content="Arun Baby">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Arun Baby">
<meta property="og:title" content="Rotate Image">
<meta property="og:url" content="https://www.arunbaby.com/dsa/0018-rotate-image/">


  <meta property="og:description" content="Learn to rotate a matrix in-place—the same pattern used for data augmentation, geometric transforms, and tensor manipulations in deep learning systems.">



  <meta property="og:image" content="https://www.arunbaby.com/assets/images/profile-photo.png">



  <meta name="twitter:site" content="@arunbaby0">
  <meta name="twitter:title" content="Rotate Image">
  <meta name="twitter:description" content="Learn to rotate a matrix in-place—the same pattern used for data augmentation, geometric transforms, and tensor manipulations in deep learning systems.">
  <meta name="twitter:url" content="https://www.arunbaby.com/dsa/0018-rotate-image/">

  
    <meta name="twitter:card" content="summary">
    
      <meta name="twitter:image" content="https://www.arunbaby.com/assets/images/profile-photo.png">
    
  

  



  <meta property="article:published_time" content="2025-11-18T21:12:02+05:30">





  

  


<link rel="canonical" href="https://www.arunbaby.com/dsa/0018-rotate-image/">












<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Arun Baby Feed">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
  
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single" dir="ltr">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
           
          <span class="site-subtitle">Arun Baby</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a
                href="/about/"
                
                
              >About</a>
            </li><li class="masthead__menu-item">
              <a
                href="/dsa/"
                
                
              >DSA</a>
            </li><li class="masthead__menu-item">
              <a
                href="/ml-system-design/"
                
                
              >ML Systems</a>
            </li><li class="masthead__menu-item">
              <a
                href="/speech-tech/"
                
                
              >Speech Tech</a>
            </li><li class="masthead__menu-item">
              <a
                href="/publications/"
                
                
              >Publications</a>
            </li><li class="masthead__menu-item">
              <a
                href="/statuses/"
                
                
              >Statuses</a>
            </li><li class="masthead__menu-item">
              <a
                href="/contact/"
                
                
              >Contact</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main" class="no-author-sidebar">
  
  <div class="sidebar sticky">
  
  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Rotate Image">
    <meta itemprop="description" content="Learn to rotate a matrix in-place—the same pattern used for data augmentation, geometric transforms, and tensor manipulations in deep learning systems.">
    <meta itemprop="datePublished" content="2025-11-18T21:12:02+05:30">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">
            <a href="https://www.arunbaby.com/dsa/0018-rotate-image/" itemprop="url">Rotate Image
</a>
          </h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          19 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu"><li><a href="#problem-statement">Problem Statement</a><ul><li><a href="#examples">Examples</a></li><li><a href="#constraints">Constraints</a></li></ul></li><li><a href="#understanding-the-problem">Understanding the Problem</a><ul><li><a href="#visual-intuition">Visual Intuition</a></li><li><a href="#why-in-place">Why In-Place?</a></li></ul></li><li><a href="#approach-1-extra-matrix-simple-but-not-in-place">Approach 1: Extra Matrix (Simple but Not In-Place)</a><ul><li><a href="#intuition">Intuition</a></li><li><a href="#implementation">Implementation</a></li><li><a href="#why-its-not-enough">Why It’s Not Enough</a></li></ul></li><li><a href="#approach-2-transpose--reverse-rows-elegant-in-place">Approach 2: Transpose + Reverse Rows (Elegant In-Place)</a><ul><li><a href="#key-idea">Key Idea</a></li><li><a href="#why-it-works">Why It Works</a></li><li><a href="#implementation-1">Implementation</a></li><li><a href="#step-by-step-example">Step-by-Step Example</a></li></ul></li><li><a href="#approach-3-layer-by-layer-4-way-swaps">Approach 3: Layer-by-Layer 4-Way Swaps</a><ul><li><a href="#intuition-1">Intuition</a></li><li><a href="#implementation-2">Implementation</a></li></ul></li><li><a href="#complexity-analysis">Complexity Analysis</a><ul><li><a href="#time-complexity">Time Complexity</a></li><li><a href="#space-complexity">Space Complexity</a></li></ul></li><li><a href="#production-considerations">Production Considerations</a></li><li><a href="#connections-to-ml-systems">Connections to ML Systems</a><ul><li><a href="#1-data-augmentation-pipelines">1. Data Augmentation Pipelines</a></li><li><a href="#2-spectrogram-manipulation-in-speech">2. Spectrogram Manipulation in Speech</a></li><li><a href="#3-distributed-tensor-sharding">3. Distributed Tensor Sharding</a></li></ul></li><li><a href="#interview-strategy">Interview Strategy</a><ul><li><a href="#how-to-communicate-your-approach">How to Communicate Your Approach</a></li><li><a href="#common-pitfalls">Common Pitfalls</a></li></ul></li><li><a href="#key-takeaways">Key Takeaways</a></li><li><a href="#problem-statement-1">Problem Statement</a><ul><li><a href="#examples-1">Examples</a></li><li><a href="#constraints-1">Constraints</a></li></ul></li><li><a href="#understanding-the-problem-1">Understanding the Problem</a><ul><li><a href="#why-in-place-matters">Why In-Place Matters</a></li></ul></li><li><a href="#approach-1-extra-matrix-brute-force">Approach 1: Extra Matrix (Brute Force)</a><ul><li><a href="#intuition-2">Intuition</a></li><li><a href="#implementation-3">Implementation</a></li><li><a href="#limitations">Limitations</a></li></ul></li><li><a href="#approach-2-transpose--reverse-rows-optimal">Approach 2: Transpose + Reverse Rows (Optimal)</a><ul><li><a href="#key-insight">Key Insight</a></li><li><a href="#why-this-works">Why This Works</a></li><li><a href="#implementation-4">Implementation</a></li><li><a href="#step-by-step-example-4x4">Step-by-Step Example (4x4)</a></li></ul></li><li><a href="#approach-3-layer-by-layer-rotation-direct-swaps">Approach 3: Layer-by-Layer Rotation (Direct Swaps)</a><ul><li><a href="#intuition-3">Intuition</a></li><li><a href="#implementation-5">Implementation</a></li></ul></li><li><a href="#implementation-notes--edge-cases">Implementation Notes &amp; Edge Cases</a></li><li><a href="#testing">Testing</a><ul><li><a href="#2-matrix-based-transforms-in-ml">2. Matrix-Based Transforms in ML</a></li><li><a href="#3-cache-friendly-implementations">3. Cache-Friendly Implementations</a></li></ul></li><li><a href="#interview-strategy-1">Interview Strategy</a><ul><li><a href="#how-to-approach-this-problem">How to Approach This Problem</a></li><li><a href="#common-pitfalls-1">Common Pitfalls</a></li><li><a href="#follow-up-questions">Follow-up Questions</a></li></ul></li><li><a href="#key-takeaways-1">Key Takeaways</a></li></ul>
            </nav>
          </aside>
        
        <p><strong>Learn to rotate a matrix in-place—the same pattern used for data augmentation, geometric transforms, and tensor manipulations in deep learning systems.</strong></p>

<h2 id="problem-statement">Problem Statement</h2>

<p>You are given an <code class="language-plaintext highlighter-rouge">n x n</code> 2D matrix representing an image. Rotate the image by <strong>90 degrees</strong> (clockwise).</p>

<p>You must rotate the image <strong>in-place</strong>, which means:</p>

<ul>
  <li>You <strong>cannot</strong> allocate another <code class="language-plaintext highlighter-rouge">n x n</code> matrix for the result.</li>
  <li>You must modify the input matrix directly.</li>
</ul>

<h3 id="examples">Examples</h3>

<p><strong>Example 1:</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Input</span><span class="p">:</span>
<span class="n">matrix</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
  <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
  <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="p">]</span>

<span class="n">Output</span><span class="p">:</span>
<span class="p">[</span>
  <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
  <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
  <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="p">]</span>
</code></pre></div></div>

<p><strong>Example 2:</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Input</span><span class="p">:</span>
<span class="n">matrix</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">[</span> <span class="mi">5</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
  <span class="p">[</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
  <span class="p">[</span><span class="mi">13</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">],</span>
  <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">16</span><span class="p">]</span>
<span class="p">]</span>

<span class="n">Output</span><span class="p">:</span>
<span class="p">[</span>
  <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">5</span><span class="p">],</span>
  <span class="p">[</span><span class="mi">14</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">1</span><span class="p">],</span>
  <span class="p">[</span><span class="mi">12</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">],</span>
  <span class="p">[</span><span class="mi">16</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span>
<span class="p">]</span>
</code></pre></div></div>

<h3 id="constraints">Constraints</h3>

<ul>
  <li>(1 \le n \le 20) (in typical interview settings; online judge may allow larger)</li>
  <li>Matrix is square: <code class="language-plaintext highlighter-rouge">len(matrix) == len(matrix[0])</code></li>
  <li>Values can be any integers</li>
</ul>

<h2 id="understanding-the-problem">Understanding the Problem</h2>

<p>This is a <strong>classic in-place matrix manipulation problem</strong>. It teaches:</p>

<ol>
  <li>How to think about <strong>2D index transformations</strong>.</li>
  <li>How to perform <strong>in-place operations</strong> without extra memory.</li>
  <li>How to decompose global transforms into <strong>local operations</strong> (layers, cycles).</li>
  <li>How matrix operations map to <strong>data transformations</strong> in ML systems.</li>
</ol>

<h3 id="visual-intuition">Visual Intuition</h3>

<p>A 90° clockwise rotation turns:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Row 0 → Column n-1
Row 1 → Column n-2
...
Row i → Column n-1-i
</code></pre></div></div>

<p>For a position ((r, c)) in the original matrix:</p>

<ul>
  <li>After rotation, it moves to: ((c, n-1-r))</li>
</ul>

<p>Example for a 3x3 matrix:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Original indices:          After 90° CW:

(0,0) (0,1) (0,2)          (2,0) (1,0) (0,0)
(1,0) (1,1) (1,2)   →      (2,1) (1,1) (0,1)
(2,0) (2,1) (2,2)          (2,2) (1,2) (0,2)
</code></pre></div></div>

<h3 id="why-in-place">Why In-Place?</h3>

<p>In many real systems:</p>

<ul>
  <li>Memory is limited (e.g., on-device ML, edge devices).</li>
  <li>Copying large image tensors is expensive.</li>
  <li>In-place transforms reduce <strong>memory bandwidth</strong> and <strong>cache pressure</strong>.</li>
</ul>

<p>This is exactly the kind of transformation you see in:</p>
<ul>
  <li>Data augmentation pipelines (image rotations),</li>
  <li>Tensor layout transforms for optimized inference/training,</li>
  <li>GPU kernels that avoid extra allocations.</li>
</ul>

<h2 id="approach-1-extra-matrix-simple-but-not-in-place">Approach 1: Extra Matrix (Simple but Not In-Place)</h2>

<h3 id="intuition">Intuition</h3>

<p>Use an extra <code class="language-plaintext highlighter-rouge">n x n</code> matrix:</p>

<ul>
  <li>For each cell <code class="language-plaintext highlighter-rouge">(r, c)</code> in original matrix, write it to <code class="language-plaintext highlighter-rouge">(c, n-1-r)</code> in new matrix.</li>
  <li>Then copy new matrix back to original.</li>
</ul>

<h3 id="implementation">Implementation</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">typing</span> <span class="kn">import</span> <span class="n">List</span>

<span class="k">def</span> <span class="nf">rotate_copy</span><span class="p">(</span><span class="n">matrix</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    \<span class="sh">"</span><span class="se">\"\"</span><span class="s">Rotate matrix 90° clockwise using extra memory.

    Time:  O(n²)
    Space: O(n²) extra

    Not allowed by the problem constraints (requires extra matrix),
    but useful to verify correctness and build intuition.
    </span><span class="se">\"\"\"</span><span class="s">
    n = len(matrix)
    rotated = [[0] * n for _ in range(n)]

    for r in range(n):
        for c in range(n):
            rotated[c][n - 1 - r] = matrix[r][c]

    # Copy back
    for r in range(n):
        for c in range(n):
            matrix[r][c] = rotated[r][c]
</span></code></pre></div></div>

<h3 id="why-its-not-enough">Why It’s Not Enough</h3>

<ul>
  <li>Uses extra <code class="language-plaintext highlighter-rouge">O(n²)</code> space.</li>
  <li>Violates the explicit in-place requirement.</li>
  <li>However, it’s great for:
    <ul>
      <li>Testing your in-place solution.</li>
      <li>Understanding the mapping <code class="language-plaintext highlighter-rouge">(r, c) → (c, n-1-r)</code>.</li>
    </ul>
  </li>
</ul>

<p>We need an <strong>in-place</strong> method.</p>

<h2 id="approach-2-transpose--reverse-rows-elegant-in-place">Approach 2: Transpose + Reverse Rows (Elegant In-Place)</h2>

<h3 id="key-idea">Key Idea</h3>

<p>A 90° clockwise rotation can be decomposed into:</p>

<ol>
  <li><strong>Transpose</strong> the matrix: reflect across main diagonal.</li>
  <li><strong>Reverse each row</strong>.</li>
</ol>

<p>Example:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Original:
1 2 3
4 5 6
7 8 9

Transpose:
1 4 7
2 5 8
3 6 9

Reverse each row:
7 4 1
8 5 2
9 6 3
</code></pre></div></div>

<p>This matches the expected rotated matrix.</p>

<h3 id="why-it-works">Why It Works</h3>

<p>Transpose swaps coordinates: ((r, c) → (c, r))</p>

<p>Then, reversing each row transforms:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(c, r) → (c, n-1-r)
</code></pre></div></div>

<p>Combining both:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(r, c)  --transpose--&gt;  (c, r)
       --reverse--&gt;     (c, n-1-r)
</code></pre></div></div>

<p>Which is exactly the 90° rotation mapping.</p>

<h3 id="implementation-1">Implementation</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">typing</span> <span class="kn">import</span> <span class="n">List</span>

<span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="n">matrix</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    \<span class="sh">"</span><span class="se">\"\"</span><span class="s">Rotate matrix 90° clockwise in-place using transpose + reverse.

    Time:  O(n²)
    Space: O(1) extra
    </span><span class="se">\"\"\"</span><span class="s">
    n = len(matrix)

    # 1. Transpose in-place: swap matrix[r][c] with matrix[c][r]
    for r in range(n):
        for c in range(r + 1, n):
            matrix[r][c], matrix[c][r] = matrix[c][r], matrix[r][c]

    # 2. Reverse each row
    for r in range(n):
        matrix[r].reverse()
</span></code></pre></div></div>

<h3 id="step-by-step-example">Step-by-Step Example</h3>

<p>For <code class="language-plaintext highlighter-rouge">matrix = [[1,2,3],[4,5,6],[7,8,9]]</code>:</p>

<ol>
  <li><strong>Transpose:</strong></li>
</ol>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1,2,3]       [1,4,7]
[4,5,6]   →   [2,5,8]
[7,8,9]       [3,6,9]
</code></pre></div></div>

<ol>
  <li><strong>Reverse each row:</strong></li>
</ol>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1,4,7]   →   [7,4,1]
[2,5,8]   →   [8,5,2]
[3,6,9]   →   [9,6,3]
</code></pre></div></div>

<p>Result: <code class="language-plaintext highlighter-rouge">[[7,4,1],[8,5,2],[9,6,3]]</code>.</p>

<h2 id="approach-3-layer-by-layer-4-way-swaps">Approach 3: Layer-by-Layer 4-Way Swaps</h2>

<h3 id="intuition-1">Intuition</h3>

<p>Think of the matrix as composed of <strong>concentric layers (rings)</strong>:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>For 4x4 matrix:
Layer 0: outer ring
Layer 1: inner 2x2 ring
</code></pre></div></div>

<p>For each layer, we rotate elements in groups of 4:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>top    → right
left   → top
bottom → left
right  → bottom
</code></pre></div></div>

<p>We can manually cycle four positions:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">top</span>    <span class="o">=</span> <span class="n">matrix</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span>
<span class="n">right</span>  <span class="o">=</span> <span class="n">matrix</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">row</span><span class="p">]</span>
<span class="n">bottom</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">row</span><span class="p">][</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">col</span><span class="p">]</span>
<span class="n">left</span>   <span class="o">=</span> <span class="n">matrix</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">col</span><span class="p">][</span><span class="n">row</span><span class="p">]</span>
</code></pre></div></div>

<h3 id="implementation-2">Implementation</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">typing</span> <span class="kn">import</span> <span class="n">List</span>

<span class="k">def</span> <span class="nf">rotate_layers</span><span class="p">(</span><span class="n">matrix</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    \<span class="sh">"</span><span class="se">\"\"</span><span class="s">Rotate matrix in-place by processing layers and 4-way swaps.</span><span class="se">\"\"\"\n</span><span class="s">    n = len(matrix)
    # Number of layers is n//2
    for layer in range(n // 2):
        first = layer
        last = n - 1 - layer
</span><span class="se">\n</span><span class="s">        for i in range(first, last):
            offset = i - first</span><span class="se">\n\n</span><span class="s">            # Save top</span><span class="se">\n</span><span class="s">            top = matrix[first][i]</span><span class="se">\n\n</span><span class="s">            # left -&gt; top</span><span class="se">\n</span><span class="s">            matrix[first][i] = matrix[last - offset][first]</span><span class="se">\n\n</span><span class="s">            # bottom -&gt; left</span><span class="se">\n</span><span class="s">            matrix[last - offset][first] = matrix[last][last - offset]</span><span class="se">\n\n</span><span class="s">            # right -&gt; bottom</span><span class="se">\n</span><span class="s">            matrix[last][last - offset] = matrix[i][last]</span><span class="se">\n\n</span><span class="s">            # top -&gt; right</span><span class="se">\n</span><span class="s">            matrix[i][last] = top</span><span class="se">\n</span><span class="s">```

### When to Use Which Approach?

- **Transpose + reverse:**
  - Simpler, fewer indices to get wrong.
  - Very common and idiomatic in interviews.
- **Layer-by-layer:**
  - Good for demonstrating deep index manipulation skills.
  - Natural extension when you need more complex per-layer logic.

Both are **O(n²)** time and **O(1)** extra space.

## Implementation: Tests and Utilities

```python
from typing import List

def rotate_in_place(matrix: List[List[int]]) -&gt; None:
    </span><span class="se">\"\"\"</span><span class="s">Wrapper for the chosen implementation (transpose + reverse).</span><span class="se">\"\"\"\n</span><span class="s">    rotate(matrix)


def test_rotate():
    tests = [
        (
            [[1,2,3],[4,5,6],[7,8,9]],
            [[7,4,1],[8,5,2],[9,6,3]],
        ),
        (
            [[5,1,9,11],[2,4,8,10],[13,3,6,7],[15,14,12,16]],
            [[15,13,2,5],[14,3,4,1],[12,6,8,9],[16,7,10,11]],
        ),
        (
            [[1]],
            [[1]],
        ),
        (
            [[1,2],[3,4]],
            [[3,1],[4,2]],
        ),
    ]

    for i, (matrix, expected) in enumerate(tests, 1):
        rotate_in_place(matrix)
        assert matrix == expected, f</span><span class="se">\"</span><span class="s">Test {i} failed: {matrix} != {expected}</span><span class="se">\"</span><span class="s">

    print(</span><span class="se">\"</span><span class="s">All rotate tests passed.</span><span class="se">\"</span><span class="s">)


if __name__ == </span><span class="se">\"</span><span class="s">__main__</span><span class="se">\"</span><span class="s">:
    test_rotate()
</span></code></pre></div></div>

<h2 id="complexity-analysis">Complexity Analysis</h2>

<p>Let (n) be the number of rows/columns (matrix is (n \times n)):</p>

<h3 id="time-complexity">Time Complexity</h3>

<ul>
  <li>We touch each element <strong>a constant number of times</strong>:
    <ul>
      <li>Transpose: (\frac{n(n-1)}{2} \approx O(n²)) swaps.</li>
      <li>Reverse each row: (n) rows × (n/2) swaps = (O(n²)).</li>
      <li>Or, in layer-by-layer, each element moves exactly once.</li>
    </ul>
  </li>
  <li>Total: (\boxed{O(n²)}).</li>
</ul>

<h3 id="space-complexity">Space Complexity</h3>

<ul>
  <li>We only use a few temporary variables (for swapping).</li>
  <li>No extra matrix allocated.</li>
  <li>Total extra space: (\boxed{O(1)}).</li>
</ul>

<h2 id="production-considerations">Production Considerations</h2>

<p>Although this is a DSA problem, the <strong>matrix rotation pattern</strong> maps directly to
real-world systems:</p>

<ul>
  <li><strong>Image data augmentation:</strong>
    <ul>
      <li>Random rotations (90°, 180°, 270°) for robustness.</li>
      <li>Often implemented via libraries (e.g., PIL, OpenCV, torchvision), but the
underlying logic is the same mapping of indices.</li>
    </ul>
  </li>
  <li><strong>Tensor layout transforms:</strong>
    <ul>
      <li>NCHW → NHWC conversions,</li>
      <li>Channel-last vs channel-first memory layouts,</li>
      <li>Strided views that avoid copies (important for GPU performance).</li>
    </ul>
  </li>
  <li><strong>Block-based transforms:</strong>
    <ul>
      <li>Splitting images into patches (e.g., Vision Transformers),</li>
      <li>Reassembling after per-block operations.</li>
    </ul>
  </li>
</ul>

<p>In performance-critical code (e.g., CUDA kernels), carefully mapping indices
and minimizing memory writes/reads is exactly what this problem trains you to do.</p>

<h2 id="connections-to-ml-systems">Connections to ML Systems</h2>

<p>The thematic link for this day is <strong>matrix operations and data transformations</strong>.
Rotating a 2D image is a prototypical example of a <strong>spatial transform</strong>.</p>

<h3 id="1-data-augmentation-pipelines">1. Data Augmentation Pipelines</h3>

<p>In ML pipelines, we often apply random transforms:</p>

<ul>
  <li>Rotations (90° increments or arbitrary angles),</li>
  <li>Flips (horizontal/vertical),</li>
  <li>Crops, scales, and perspective warps.</li>
</ul>

<p>These transforms are all <strong>coordinate mappings</strong>:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>output[x', y'] = input[f(x', y')]
</code></pre></div></div>

<p>Understanding the simple case (90° rotation) makes it easier to reason about
more complex geometric transforms used in computer vision and even spectrogram
augmentations in speech.</p>

<h3 id="2-spectrogram-manipulation-in-speech">2. Spectrogram Manipulation in Speech</h3>

<p>Audio models often consume <strong>time-frequency matrices</strong> (spectrograms). Rotations
are less common, but operations like:</p>

<ul>
  <li>Time masking,</li>
  <li>Frequency masking,</li>
  <li>Time warping,</li>
</ul>

<p>are all implemented by manipulating slices along the axes. The mental model of
"treat this 2D array as a geometric object and transform its indices" is the
same one you use here.</p>

<h3 id="3-distributed-tensor-sharding">3. Distributed Tensor Sharding</h3>

<p>In large-scale ML training, tensors are sharded across devices:</p>

<ul>
  <li>Splitting along batch dimension,</li>
  <li>Splitting along feature/channel dimensions,</li>
  <li>Sometimes even 2D sharding of weight matrices.</li>
</ul>

<p>The underlying operations often boil down to:</p>

<ul>
  <li>Slicing submatrices,</li>
  <li>Reassembling them after all-reduce or all-gather,</li>
  <li>Maintaining consistent index mappings across devices.</li>
</ul>

<p>Being fluent with small 2D index transformations (like Rotate Image) helps you
avoid subtle bugs when working with large sharded tensors.</p>

<h2 id="interview-strategy">Interview Strategy</h2>

<h3 id="how-to-communicate-your-approach">How to Communicate Your Approach</h3>

<p>In an interview, structure your explanation like this:</p>

<ol>
  <li><strong>Clarify constraints:</strong>
    <ul>
      <li>Square matrix?</li>
      <li>In-place required?</li>
      <li>90° clockwise only, or arbitrary rotations?</li>
    </ul>
  </li>
  <li><strong>Outline the naive solution (extra matrix):</strong>
    <ul>
      <li>Talk through <code class="language-plaintext highlighter-rouge">(r, c) → (c, n-1-r)</code>.</li>
      <li>Acknowledge extra <code class="language-plaintext highlighter-rouge">O(n²)</code> memory and why it’s not allowed.</li>
    </ul>
  </li>
  <li><strong>Present the in-place solution:</strong>
    <ul>
      <li>Option A: transpose + reverse.</li>
      <li>Option B: layer-by-layer 4-way swaps.</li>
      <li>Pick one and explain why it’s simpler/safer to implement.</li>
    </ul>
  </li>
  <li><strong>Discuss complexity:</strong>
    <ul>
      <li>Time: <code class="language-plaintext highlighter-rouge">O(n²)</code>, Space: <code class="language-plaintext highlighter-rouge">O(1)</code> extra.</li>
    </ul>
  </li>
  <li><strong>(Bonus) Mention applications:</strong>
    <ul>
      <li>Data augmentation, tensor transforms, geometric reasoning.</li>
    </ul>
  </li>
</ol>

<h3 id="common-pitfalls">Common Pitfalls</h3>

<ul>
  <li>Forgetting that transpose should only swap above the diagonal
(<code class="language-plaintext highlighter-rouge">for c in range(r+1, n)</code>), otherwise you double-swap.</li>
  <li>Mixing up row/column indices when computing the 4-way swaps.</li>
  <li>Accidentally using an extra <code class="language-plaintext highlighter-rouge">n x n</code> matrix (violates in-place requirement).</li>
</ul>

<h2 id="key-takeaways">Key Takeaways</h2>

<p>✅ <strong>90° rotation is just a coordinate transform</strong>: ((r, c) → (c, n-1-r)).</p>

<p>✅ <strong>Transpose + reverse rows</strong> gives a clean, in-place implementation.</p>

<p>✅ <strong>Layer-by-layer 4-way swaps</strong> are a more manual but instructive alternative.</p>

<p>✅ <strong>Time complexity is O(n²)</strong> and <strong>extra space is O(1)</strong>.</p>

<p>✅ <strong>Matrix transforms</strong> like this appear in data augmentation, tensor layout
changes, and distributed tensor sharding.</p>

<p>✅ <strong>Thinking in terms of index mappings</strong> is a valuable skill for both algorithm
interviews and real-world ML systems work.</p>

<hr />

<p><strong>Originally published at:</strong> <a href="https://www.arunbaby.com/dsa/0018-rotate-image/">arunbaby.com/dsa/0018-rotate-image</a></p>

<p><em>If you found this helpful, consider sharing it with others who might benefit.</em></p>

<hr />
<p>title: “Rotate Image”
day: 18
collection: dsa
categories:</p>
<ul>
  <li>dsa
tags:</li>
  <li>matrix</li>
  <li>array</li>
  <li>in-place</li>
  <li>simulation</li>
  <li>2d-transform</li>
  <li>medium
subdomain: “Matrix &amp; 2D Array Algorithms”
tech_stack: [Python]
scale: “O(N²) time, O(1) extra space”
companies: [Google, Meta, Amazon, Microsoft, Apple]
related_dsa_day: 18
related_ml_day: 18
related_speech_day: 18
—</li>
</ul>

<p><strong>Master in-place matrix rotation—the same pattern used in data augmentation pipelines and log-mel transformations for speech.</strong></p>

<h2 id="problem-statement-1">Problem Statement</h2>

<p>You are given an <code class="language-plaintext highlighter-rouge">n x n</code> 2D matrix representing an image. Rotate the image by <strong>90 degrees (clockwise)</strong>.</p>

<p>You must rotate the matrix <strong>in-place</strong>, which means you have to modify the input matrix directly. <strong>Do not allocate another 2D matrix for the rotation.</strong></p>

<h3 id="examples-1">Examples</h3>

<p><strong>Example 1:</strong></p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Input:
[
  [1,2,3],
  [4,5,6],
  [7,8,9]
]

Output:
[
  [7,4,1],
  [8,5,2],
  [9,6,3]
]
</code></pre></div></div>

<p><strong>Example 2:</strong></p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Input:
[
  [ 5, 1, 9,11],
  [ 2, 4, 8,10],
  [13, 3, 6, 7],
  [15,14,12,16]
]

Output:
[
  [15,13, 2, 5],
  [14, 3, 4, 1],
  [12, 6, 8, 9],
  [16, 7,10,11]
]
</code></pre></div></div>

<h3 id="constraints-1">Constraints</h3>

<ul>
  <li><code class="language-plaintext highlighter-rouge">n == matrix.length</code></li>
  <li><code class="language-plaintext highlighter-rouge">n == matrix[i].length</code></li>
  <li><code class="language-plaintext highlighter-rouge">1 &lt;= n &lt;= 20</code></li>
  <li><code class="language-plaintext highlighter-rouge">-1000 &lt;= matrix[i][j] &lt;= 1000</code></li>
</ul>

<h2 id="understanding-the-problem-1">Understanding the Problem</h2>

<p>We have a square matrix (image) and need to rotate it <strong>90° clockwise</strong> in-place.</p>

<p>Visually:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Original (3x3):
1 2 3
4 5 6
7 8 9

Rotated 90° clockwise:
7 4 1
8 5 2
9 6 3
</code></pre></div></div>

<p>Think of coordinates:</p>
<ul>
  <li>Original indices: <code class="language-plaintext highlighter-rouge">(row, col)</code></li>
  <li>After rotation: <code class="language-plaintext highlighter-rouge">(row, col) -&gt; (col, n - 1 - row)</code></li>
</ul>

<p>This is a <strong>2D coordinate transform</strong>—exactly the kind of operation we do in:</p>
<ul>
  <li>Image augmentations (rotate, flip),</li>
  <li>Log-mel spectrogram manipulations,</li>
  <li>Matrix-based data transformations.</li>
</ul>

<h3 id="why-in-place-matters">Why In-Place Matters</h3>

<p>Naively, you could allocate a new <code class="language-plaintext highlighter-rouge">n x n</code> matrix and write:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rotated</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">row</span><span class="p">]</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span>
</code></pre></div></div>

<p>But the problem explicitly asks for <strong>in-place</strong>:</p>

<ul>
  <li><strong>Space constraint</strong>: O(1) extra memory</li>
  <li>Focus on <strong>in-place algorithms</strong> and index manipulation</li>
</ul>

<p>This is common in:</p>
<ul>
  <li>Memory-constrained systems,</li>
  <li>High-performance pipelines,</li>
  <li>Large tensors in ML systems.</li>
</ul>

<h2 id="approach-1-extra-matrix-brute-force">Approach 1: Extra Matrix (Brute Force)</h2>

<h3 id="intuition-2">Intuition</h3>

<ol>
  <li>Allocate a new <code class="language-plaintext highlighter-rouge">n x n</code> matrix <code class="language-plaintext highlighter-rouge">rot</code>.</li>
  <li>For each <code class="language-plaintext highlighter-rouge">(i, j)</code> in original:
    <ul>
      <li>Set <code class="language-plaintext highlighter-rouge">rot[j][n - 1 - i] = matrix[i][j]</code>.</li>
    </ul>
  </li>
  <li>Copy <code class="language-plaintext highlighter-rouge">rot</code> back into <code class="language-plaintext highlighter-rouge">matrix</code>.</li>
</ol>

<h3 id="implementation-3">Implementation</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">typing</span> <span class="kn">import</span> <span class="n">List</span>

<span class="k">def</span> <span class="nf">rotate_bruteforce</span><span class="p">(</span><span class="n">matrix</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    \<span class="sh">"</span><span class="se">\"\"</span><span class="s">Rotate matrix 90° clockwise using extra matrix.

    Time:  O(N²)
    Space: O(N²) extra
    </span><span class="se">\"\"\"</span><span class="s">
    n = len(matrix)
    # Create rotated matrix
    rot = [[0] * n for _ in range(n)]

    for i in range(n):
        for j in range(n):
            # Map (i, j) -&gt; (j, n - 1 - i)
            rot[j][n - 1 - i] = matrix[i][j]

    # Copy back
    for i in range(n):
        for j in range(n):
            matrix[i][j] = rot[i][j]
</span></code></pre></div></div>

<h3 id="limitations">Limitations</h3>

<ul>
  <li>Violates space constraint (allocates another <code class="language-plaintext highlighter-rouge">n x n</code> matrix).</li>
  <li>Interviewers typically want <strong>O(1) extra space</strong>.</li>
</ul>

<p>But this approach helps build intuition about the coordinate transform.</p>

<h2 id="approach-2-transpose--reverse-rows-optimal">Approach 2: Transpose + Reverse Rows (Optimal)</h2>

<h3 id="key-insight">Key Insight</h3>

<p>A 90° clockwise rotation can be factored into two simpler operations:</p>

<ol>
  <li><strong>Transpose</strong> the matrix (swap rows and columns).</li>
  <li><strong>Reverse each row</strong>.</li>
</ol>

<p>Let’s see it on a 3x3 example:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Original:
1 2 3
4 5 6
7 8 9

Transpose (swap matrix[i][j] with matrix[j][i]):
1 4 7
2 5 8
3 6 9

Reverse each row:
7 4 1
8 5 2
9 6 3
</code></pre></div></div>

<p>Exactly what we want!</p>

<h3 id="why-this-works">Why This Works</h3>

<p>The transpose operation maps:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">(i, j) -&gt; (j, i)</code></li>
</ul>

<p>After transpose, reversing row <code class="language-plaintext highlighter-rouge">i</code> maps:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">(i, j) -&gt; (i, n - 1 - j)</code></li>
</ul>

<p>Compose these transformations:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Original index: (i, j)
After transpose: (j, i)
After row reverse: (j, n - 1 - i)
</code></pre></div></div>

<p>Which is exactly the coordinate for a 90° clockwise rotation.</p>

<h3 id="implementation-4">Implementation</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">typing</span> <span class="kn">import</span> <span class="n">List</span>

<span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="n">matrix</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    \<span class="sh">"</span><span class="se">\"\"</span><span class="s">Rotate matrix 90° clockwise in-place.

    Uses transpose + reverse rows.

    Time:  O(N²)
    Space: O(1) extra
    </span><span class="se">\"\"\"</span><span class="s">
    n = len(matrix)

    # 1. Transpose in-place
    for i in range(n):
        for j in range(i + 1, n):
            matrix[i][j], matrix[j][i] = matrix[j][i], matrix[i][j]

    # 2. Reverse each row
    for i in range(n):
        matrix[i].reverse()
</span></code></pre></div></div>

<h3 id="step-by-step-example-4x4">Step-by-Step Example (4x4)</h3>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Original:
 5  1  9 11
 2  4  8 10
13  3  6  7
15 14 12 16

Transpose:
 5  2 13 15
 1  4  3 14
 9  8  6 12
11 10  7 16

Reverse each row:
15 13  2  5
14  3  4  1
12  6  8  9
16  7 10 11
</code></pre></div></div>

<p>Exactly matches the example output.</p>

<h2 id="approach-3-layer-by-layer-rotation-direct-swaps">Approach 3: Layer-by-Layer Rotation (Direct Swaps)</h2>

<h3 id="intuition-3">Intuition</h3>

<p>We can think of the matrix as a series of <strong>concentric layers</strong> (rings) and rotate each layer independently.</p>

<p>For a 4x4:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Layer 0 (outer):
 [0,0] [0,1] [0,2] [0,3]
 [1,0]             [1,3]
 [2,0]             [2,3]
 [3,0] [3,1] [3,2] [3,3]

Layer 1 (inner):
 [1,1] [1,2]
 [2,1] [2,2]
</code></pre></div></div>

<p>For each layer, we rotate elements in groups of 4:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>top    -&gt; right
left   -&gt; top
bottom -&gt; left
right  -&gt; bottom
</code></pre></div></div>

<h3 id="implementation-5">Implementation</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">rotate_layer_by_layer</span><span class="p">(</span><span class="n">matrix</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    \<span class="sh">"</span><span class="se">\"\"</span><span class="s">Rotate matrix 90° clockwise in-place by rotating layers.</span><span class="se">\"\"\"\n</span><span class="s">    n = len(matrix)
    left, right = 0, n - 1

    while left &lt; right:
        top, bottom = left, right

        # Rotate the current layer
        for i in range(right - left):
            # Save top-left
            top_left = matrix[top][left + i]

            # Move bottom-left -&gt; top-left
            matrix[top][left + i] = matrix[bottom - i][left]

            # Move bottom-right -&gt; bottom-left
            matrix[bottom - i][left] = matrix[bottom][right - i]

            # Move top-right -&gt; bottom-right
            matrix[bottom][right - i] = matrix[top + i][right]

            # Move saved top-left -&gt; top-right
            matrix[top + i][right] = top_left

        left += 1
        right -= 1
</span></code></pre></div></div>

<p>This approach is more explicit and useful when:</p>
<ul>
  <li>You need more control over which elements move where,</li>
  <li>You want to rotate by 90°, 180°, or 270° with different patterns.</li>
</ul>

<p>But for interviews, <strong>transpose + reverse</strong> is simpler and less bug-prone.</p>

<h2 id="implementation-notes--edge-cases">Implementation Notes &amp; Edge Cases</h2>

<ol>
  <li><strong>Empty matrix / 1x1 matrix:</strong>
    <ul>
      <li><code class="language-plaintext highlighter-rouge">n = 0</code> or <code class="language-plaintext highlighter-rouge">n = 1</code> → rotation is a no-op.</li>
    </ul>
  </li>
  <li><strong>Negative / large values:</strong>
    <ul>
      <li>Values don’t matter; we only move them.</li>
    </ul>
  </li>
  <li><strong>In-place safety:</strong>
    <ul>
      <li>Ensure you don’t override values before they’ve been used (layer approach).</li>
    </ul>
  </li>
</ol>

<h2 id="testing">Testing</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">copy</span>

<span class="k">def</span> <span class="nf">test_rotate</span><span class="p">():</span>
    <span class="n">tests</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span>
            <span class="p">[</span>
                <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span>
            <span class="p">],</span>
            <span class="p">[</span>
                <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
            <span class="p">]</span>
        <span class="p">),</span>
        <span class="p">(</span>
            <span class="p">[</span>
                <span class="p">[</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span><span class="mi">11</span><span class="p">],</span>
                <span class="p">[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">15</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">16</span><span class="p">]</span>
            <span class="p">],</span>
            <span class="p">[</span>
                <span class="p">[</span><span class="mi">15</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">]</span>
            <span class="p">]</span>
        <span class="p">),</span>
        <span class="p">(</span>
            <span class="p">[[</span><span class="mi">1</span><span class="p">]],</span>
            <span class="p">[[</span><span class="mi">1</span><span class="p">]],</span>
        <span class="p">),</span>
        <span class="p">(</span>
            <span class="p">[</span>
                <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
            <span class="p">],</span>
            <span class="p">[</span>
                <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
            <span class="p">]</span>
        <span class="p">)</span>
    <span class="p">]</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">tests</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">m1</span> <span class="o">=</span> <span class="n">copy</span><span class="p">.</span><span class="nf">deepcopy</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
        <span class="nf">rotate</span><span class="p">(</span><span class="n">m1</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">m1</span> <span class="o">==</span> <span class="n">expected</span><span class="p">,</span> <span class="n">f</span>\<span class="sh">"</span><span class="s">Test {i} failed: {m1} != {expected}</span><span class="se">\"</span><span class="s">

    print(</span><span class="se">\"</span><span class="s">All tests passed for rotate().</span><span class="se">\"</span><span class="s">)</span><span class="se">\n\n\n</span><span class="s">if __name__ == </span><span class="se">\"</span><span class="s">__main__</span><span class="se">\"</span><span class="s">:</span><span class="se">\n</span><span class="s">    test_rotate()</span><span class="se">\n</span><span class="s">```

## Complexity Analysis

Let \(n\) be the dimension of the matrix (`n x n`).

### Time Complexity

- We visit each element a constant number of times.
- Total elements: \(n^2\).
- Time complexity: \(O(n^2)\).

### Space Complexity

- We only use a few scalar variables (indices, temporary storage).
- No extra `n x n` matrix is allocated.
- Space complexity: \(O(1)\) extra.

## Production Considerations

Although this is a DSA problem, the pattern shows up in real systems:

### 1. Image Data Augmentation

- Rotate input images by multiples of 90° for data augmentation.
- In practice, libraries (OpenCV, PIL, torchvision) handle this efficiently.
- But under the hood, they perform **coordinate transforms** similar to this:

```python
def rotate_90(image):
    # Using NumPy for brevity
    return np.rot90(image, k=-1)  # 90° clockwise
</span></code></pre></div></div>

<p>Understanding the index math helps when:</p>
<ul>
  <li>You implement custom augmentations (e.g., rotate log-mel spectrograms),</li>
  <li>You debug misaligned data (e.g., labels not matching rotated images).</li>
</ul>

<h3 id="2-matrix-based-transforms-in-ml">2. Matrix-Based Transforms in ML</h3>

<ul>
  <li>Many ML ops are linear algebra transformations on matrices/tensors:
    <ul>
      <li>Transpose, reshape, permute,</li>
      <li>Rotations and flips for data augmentation,</li>
      <li>Time-frequency transforms in speech.</li>
    </ul>
  </li>
  <li>This problem forces you to reason about <strong>index mappings</strong>:
    <ul>
      <li>From <code class="language-plaintext highlighter-rouge">(i, j)</code> to <code class="language-plaintext highlighter-rouge">(j, n - 1 - i)</code>,</li>
      <li>Or more complex patterns in real models.</li>
    </ul>
  </li>
</ul>

<h3 id="3-cache-friendly-implementations">3. Cache-Friendly Implementations</h3>

<ul>
  <li>Transpose + reverse rows can be more cache-friendly than arbitrary swaps.</li>
  <li>For very large matrices/tensors, memory access patterns matter:
    <ul>
      <li>Contiguous access vs random access,</li>
      <li>Minimizing cache misses.</li>
    </ul>
  </li>
</ul>

<h2 id="interview-strategy-1">Interview Strategy</h2>

<h3 id="how-to-approach-this-problem">How to Approach This Problem</h3>

<p><strong>1. Clarify (1–2 minutes)</strong></p>

<ul>
  <li>Matrix is always square? (Yes, here.)</li>
  <li>Rotation direction? (90° clockwise.)</li>
  <li>In-place requirement? (Yes → no extra <code class="language-plaintext highlighter-rouge">n x n</code>.)</li>
</ul>

<p><strong>2. Start with a simple but suboptimal solution</strong></p>

<blockquote>
  <p>"First, I’d solve it by allocating a new matrix and writing 
<code class="language-plaintext highlighter-rouge">rot[j][n-1-i] = matrix[i][j]</code>. That’s O(n²) time and O(n²) space. 
Then I’ll optimize to do it in-place."</p>
</blockquote>

<p><strong>3. Present transpose + reverse idea</strong></p>

<p>Explain the math and walk through a 3x3 example.</p>

<p><strong>4. Implement carefully</strong></p>

<ul>
  <li>Watch indices in the transpose loop (<code class="language-plaintext highlighter-rouge">for j in range(i+1, n)</code>).</li>
  <li>Use built-in <code class="language-plaintext highlighter-rouge">reverse()</code> for clarity and safety.</li>
</ul>

<p><strong>5. Discuss layer-by-layer as an alternative</strong></p>

<ul>
  <li>Shows deeper understanding.</li>
  <li>But emphasize that transpose + reverse is usually preferred.</li>
</ul>

<h3 id="common-pitfalls-1">Common Pitfalls</h3>

<ol>
  <li><strong>Transposing incorrectly:</strong>
    <ul>
      <li>Using <code class="language-plaintext highlighter-rouge">for j in range(n)</code> instead of <code class="language-plaintext highlighter-rouge">range(i+1, n)</code> → double-swap and revert.</li>
    </ul>
  </li>
  <li><strong>Index off-by-one errors</strong> in layer-based rotation.</li>
  <li><strong>Not handling small matrices</strong> (e.g., <code class="language-plaintext highlighter-rouge">n = 1</code>).</li>
</ol>

<h3 id="follow-up-questions">Follow-up Questions</h3>

<ol>
  <li><strong>Rotate 90° counter-clockwise or 180°:</strong>
    <ul>
      <li>90° counter-clockwise:
        <ul>
          <li>Transpose, then reverse <strong>columns</strong> instead of rows.</li>
        </ul>
      </li>
      <li>180°:
        <ul>
          <li>Reverse rows, then reverse columns,</li>
          <li>Or apply 90° rotation twice.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li><strong>Non-square matrices?</strong>
    <ul>
      <li>Out of scope for this problem,</li>
      <li>But you can still perform generalized rotate operations using a new matrix.</li>
    </ul>
  </li>
  <li><strong>Apply to tensors (e.g., <code class="language-plaintext highlighter-rouge">H x W x C</code> images)?</strong>
    <ul>
      <li>Either rotate channels independently,</li>
      <li>Or treat <code class="language-plaintext highlighter-rouge">H x W</code> as the rotation plane and keep <code class="language-plaintext highlighter-rouge">C</code> fixed.</li>
    </ul>
  </li>
</ol>

<h2 id="key-takeaways-1">Key Takeaways</h2>

<p>✅ <strong>Matrix rotation is just a coordinate transform</strong>—from <code class="language-plaintext highlighter-rouge">(i, j)</code> to <code class="language-plaintext highlighter-rouge">(j, n - 1 - i)</code>.</p>

<p>✅ <strong>Transpose + reverse rows</strong> gives an elegant, in-place O(n²) solution.</p>

<p>✅ <strong>Layer-by-layer rotation</strong> is a more explicit but error-prone alternative.</p>

<p>✅ <strong>Index math mastery</strong> pays off in both interviews and production ML code.</p>

<p>✅ <strong>The same pattern appears</strong> in image augmentation, spectrogram manipulation, and other data transformations.</p>

<hr />

<p><strong>Originally published at:</strong> <a href="https://www.arunbaby.com/dsa/0018-rotate-image/">arunbaby.com/dsa/0018-rotate-image</a></p>

<p><em>If you found this helpful, consider sharing it with others who might benefit.</em></p>


        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#2d-array" class="page__taxonomy-item p-category" rel="tag">2d-array</a><span class="sep">, </span>
    
      <a href="/tags/#in-place" class="page__taxonomy-item p-category" rel="tag">in-place</a><span class="sep">, </span>
    
      <a href="/tags/#matrix" class="page__taxonomy-item p-category" rel="tag">matrix</a><span class="sep">, </span>
    
      <a href="/tags/#medium" class="page__taxonomy-item p-category" rel="tag">medium</a><span class="sep">, </span>
    
      <a href="/tags/#rotation" class="page__taxonomy-item p-category" rel="tag">rotation</a><span class="sep">, </span>
    
      <a href="/tags/#simulation" class="page__taxonomy-item p-category" rel="tag">simulation</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#dsa" class="page__taxonomy-item p-category" rel="tag">dsa</a>
    
    </span>
  </p>


        
      </footer>

      <div class="page__related page__related--full">
  <h2 class="page__related-title">Related across topics</h2>
  <style>
    /* Make section span full content width and use 2 equal columns */
    .page__related--full { float: inline-start; width: 100%; padding: 0; }
    .cross-related-grid { display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 2rem; }
    @media (max-width: 768px) { .cross-related-grid { grid-template-columns: 1fr; } }
    /* Ensure archive cards stretch nicely in the grid */
    .cross-related-grid .list__item, .cross-related-grid .grid__item { width: auto; float: none; margin: 0; }
  </style>
  <div class="cross-related-grid">
    



<div class="list__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/dsa/0018-rotate-image/" rel="permalink">Rotate Image
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          19 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Learn to rotate a matrix in-place—the same pattern used for data augmentation, geometric transforms, and tensor manipulations in deep learning systems.
</p>
  </article>
</div>




<div class="list__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/ml-system-design/0018-data-augmentation-pipeline/" rel="permalink">Data Augmentation Pipeline
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          9 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Design a robust data augmentation pipeline that applies rich transformations to large-scale datasets without becoming the training bottleneck.
</p>
  </article>
</div>




<div class="list__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/speech-tech/0018-audio-augmentation-techniques/" rel="permalink">Audio Augmentation Techniques
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          8 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Use audio augmentation techniques to make speech models robust to noise, accents, channels, and real-world conditions—built on the same matrix/tensor transfo...</p>
  </article>
</div>

  </div>
</div>

      <section class="page__share">
  <h4 class="page__share-title">Share on</h4>

  <a href="https://twitter.com/intent/tweet?via=arunbaby0&text=Rotate+Image%20https%3A%2F%2Fwww.arunbaby.com%2Fdsa%2F0018-rotate-image%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.arunbaby.com%2Fdsa%2F0018-rotate-image%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.arunbaby.com/dsa/0018-rotate-image/" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/dsa/0017-add-two-numbers-linked-list/" class="pagination--pager" title="Add Two Numbers (Linked List)">Previous</a>
    
    
      <a href="#" class="pagination--pager disabled">Next</a>
    
  </nav>


    </div>

    
  </article>

  
  
</div>

      
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://twitter.com/arunbaby0" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://github.com/arunbaby0" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
          <li><a href="https://www.linkedin.com/in/arunbaby0/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
        
      
        
          <li><a href="https://scholar.google.co.in/citations?user=6fSYWhkAAAAJ" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-graduation-cap" aria-hidden="true"></i> Google Scholar</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 1990 - 2143 <a href="https://www.arunbaby.com">Arun Baby</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0JRJPEC9SS"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-0JRJPEC9SS', { 'anonymize_ip': false});
</script>








  </body>
</html>
