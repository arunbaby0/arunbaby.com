<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.26.2 by Michael Rose
  Copyright 2013-2024 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->

<html lang="en-US" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Sliding Window Maximum - Arun Baby</title>
<meta name="description" content="“Finding the king of every window.”">


  <meta name="author" content="Arun Baby">
  
  <meta property="article:author" content="Arun Baby">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Arun Baby">
<meta property="og:title" content="Sliding Window Maximum">
<meta property="og:url" content="https://www.arunbaby.com/dsa/0045-sliding-window-maximum/">


  <meta property="og:description" content="“Finding the king of every window.”">



  <meta property="og:image" content="https://www.arunbaby.com/assets/images/profile-photo.png">



  <meta name="twitter:site" content="@arunbaby0">
  <meta name="twitter:title" content="Sliding Window Maximum">
  <meta name="twitter:description" content="“Finding the king of every window.”">
  <meta name="twitter:url" content="https://www.arunbaby.com/dsa/0045-sliding-window-maximum/">

  
    <meta name="twitter:card" content="summary">
    
      <meta name="twitter:image" content="https://www.arunbaby.com/assets/images/profile-photo.png">
    
  

  



  <meta property="article:published_time" content="2025-12-21T18:17:50+05:30">





  

  


<link rel="canonical" href="https://www.arunbaby.com/dsa/0045-sliding-window-maximum/">












<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Arun Baby Feed">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
  
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single" dir="ltr">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
           
          <span class="site-subtitle">Arun Baby</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a
                href="/about/"
                
                
              >About</a>
            </li><li class="masthead__menu-item">
              <a
                href="/dsa/"
                
                
              >DSA</a>
            </li><li class="masthead__menu-item">
              <a
                href="/ml-system-design/"
                
                
              >ML Systems</a>
            </li><li class="masthead__menu-item">
              <a
                href="/speech-tech/"
                
                
              >Speech Tech</a>
            </li><li class="masthead__menu-item">
              <a
                href="/ai-agents/"
                
                
              >AI Agents</a>
            </li><li class="masthead__menu-item">
              <a
                href="/publications/"
                
                
              >Publications</a>
            </li><li class="masthead__menu-item">
              <a
                href="/statuses/"
                
                
              >Statuses</a>
            </li><li class="masthead__menu-item">
              <a
                href="/contact/"
                
                
              >Contact</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main" class="no-author-sidebar">
  
  <div class="sidebar sticky">
  
  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Sliding Window Maximum">
    <meta itemprop="description" content="“Finding the king of every window.”">
    <meta itemprop="datePublished" content="2025-12-21T18:17:50+05:30">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">
            <a href="https://www.arunbaby.com/dsa/0045-sliding-window-maximum/" itemprop="url">Sliding Window Maximum
</a>
          </h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          13 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu"><li><a href="#1-problem-statement">1. Problem Statement</a></li><li><a href="#2-intuition">2. Intuition</a></li><li><a href="#3-approach-1-brute-force">3. Approach 1: Brute Force</a></li><li><a href="#4-approach-2-monotonic-deque-optimal">4. Approach 2: Monotonic Deque (Optimal)</a></li><li><a href="#5-detailed-walkthrough">5. Detailed Walkthrough</a></li><li><a href="#6-why-monotonic-deque-works">6. Why Monotonic Deque Works</a></li><li><a href="#7-approach-3-segment-tree">7. Approach 3: Segment Tree</a></li><li><a href="#8-approach-4-sparse-table-static">8. Approach 4: Sparse Table (Static)</a></li><li><a href="#9-extension-sliding-window-minimum">9. Extension: Sliding Window Minimum</a></li><li><a href="#10-related-problem-shortest-subarray-with-sum-at-least-k">10. Related Problem: Shortest Subarray with Sum at Least K</a></li><li><a href="#11-system-design-real-time-analytics">11. System Design: Real-Time Analytics</a></li><li><a href="#12-interview-questions">12. Interview Questions</a></li><li><a href="#13-common-mistakes">13. Common Mistakes</a></li><li><a href="#14-variant-count-elements-greater-than-x-in-each-window">14. Variant: Count Elements Greater Than X in Each Window</a></li><li><a href="#15-variant-median-of-sliding-window">15. Variant: Median of Sliding Window</a></li><li><a href="#16-performance-comparison">16. Performance Comparison</a></li><li><a href="#17-deep-dive-deque-implementation">17. Deep Dive: Deque Implementation</a></li><li><a href="#18-application-stock-price-analysis">18. Application: Stock Price Analysis</a></li><li><a href="#19-conclusion">19. Conclusion</a></li><li><a href="#20-mastery-checklist">20. Mastery Checklist</a></li><li><a href="#21-advanced-application-jump-game-vi">21. Advanced Application: Jump Game VI</a></li><li><a href="#22-advanced-application-constrained-subsequence-sum">22. Advanced Application: Constrained Subsequence Sum</a></li><li><a href="#23-pattern-recognition">23. Pattern Recognition</a></li><li><a href="#24-implementation-variants">24. Implementation Variants</a><ul><li><a href="#241-using-tuple-value-index">24.1. Using Tuple (Value, Index)</a></li><li><a href="#242-max-heap-with-lazy-deletion">24.2. Max-Heap with Lazy Deletion</a></li></ul></li><li><a href="#25-testing-strategy">25. Testing Strategy</a></li><li><a href="#26-complexity-deep-dive">26. Complexity Deep Dive</a></li><li><a href="#27-related-leetcode-problems">27. Related LeetCode Problems</a></li><li><a href="#28-conclusion">28. Conclusion</a></li></ul>
            </nav>
          </aside>
        
        <p><strong>“Finding the king of every window.”</strong></p>

<h2 id="1-problem-statement">1. Problem Statement</h2>

<p>You are given an array of integers <code class="language-plaintext highlighter-rouge">nums</code>, and there is a sliding window of size <code class="language-plaintext highlighter-rouge">k</code> which moves from the very left to the very right. You can only see the <code class="language-plaintext highlighter-rouge">k</code> numbers in the window. Each time the sliding window moves right by one position, return the max of each window.</p>

<p><strong>Example:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Input: nums = [1,3,-1,-3,5,3,6,7], k = 3
Output: [3,3,5,5,6,7]
Explanation:
Window position                Max
---------------               -----
[1  3  -1] -3  5  3  6  7       3
 1 [3  -1  -3] 5  3  6  7       3
 1  3 [-1  -3  5] 3  6  7       5
 1  3  -1 [-3  5  3] 6  7       5
 1  3  -1  -3 [5  3  6] 7       6
 1  3  -1  -3  5 [3  6  7]      7
</code></pre></div></div>

<p><strong>Constraints:</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">1 &lt;= nums.length &lt;= 10^5</code></li>
  <li><code class="language-plaintext highlighter-rouge">-10^4 &lt;= nums[i] &lt;= 10^4</code></li>
  <li><code class="language-plaintext highlighter-rouge">1 &lt;= k &lt;= nums.length</code></li>
</ul>

<h2 id="2-intuition">2. Intuition</h2>

<p><strong>Naive Approach:</strong> For each window, scan all <code class="language-plaintext highlighter-rouge">k</code> elements to find max. $O(n \cdot k)$.</p>

<p><strong>Key Insight:</strong> We don’t need to consider elements that are:</p>
<ol>
  <li><strong>Out of the window:</strong> Elements more than <code class="language-plaintext highlighter-rouge">k</code> positions behind.</li>
  <li><strong>Dominated:</strong> If <code class="language-plaintext highlighter-rouge">nums[j] &gt;= nums[i]</code> and <code class="language-plaintext highlighter-rouge">j &gt; i</code>, then <code class="language-plaintext highlighter-rouge">nums[i]</code> can never be the max.</li>
</ol>

<p><strong>Solution:</strong> Use a <strong>monotonic deque</strong> that stores indices of useful elements (in decreasing order of their values).</p>

<h2 id="3-approach-1-brute-force">3. Approach 1: Brute Force</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">maxSlidingWindow</span><span class="p">(</span><span class="n">nums</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">window_max</span> <span class="o">=</span> <span class="nf">max</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">k</span><span class="p">])</span>
        <span class="n">result</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">window_max</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></div>

<p><strong>Complexity:</strong></p>
<ul>
  <li><strong>Time:</strong> $O(n \cdot k)$.</li>
  <li><strong>Space:</strong> $O(1)$ (excluding output).</li>
</ul>

<h2 id="4-approach-2-monotonic-deque-optimal">4. Approach 2: Monotonic Deque (Optimal)</h2>

<p><strong>Algorithm:</strong></p>
<ol>
  <li>Maintain a deque of indices in decreasing order of values.</li>
  <li>For each element:
    <ul>
      <li>Remove indices outside the current window (from front).</li>
      <li>Remove indices of elements smaller than current (from back).</li>
      <li>Add current index (to back).</li>
      <li>If window is complete, front of deque is the max.</li>
    </ul>
  </li>
</ol>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">collections</span> <span class="kn">import</span> <span class="n">deque</span>

<span class="k">def</span> <span class="nf">maxSlidingWindow</span><span class="p">(</span><span class="n">nums</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="n">dq</span> <span class="o">=</span> <span class="nf">deque</span><span class="p">()</span>  <span class="c1"># Stores indices
</span>    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)):</span>
        <span class="c1"># Remove indices outside window
</span>        <span class="k">while</span> <span class="n">dq</span> <span class="ow">and</span> <span class="n">dq</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">i</span> <span class="o">-</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">dq</span><span class="p">.</span><span class="nf">popleft</span><span class="p">()</span>
        
        <span class="c1"># Remove smaller elements (they'll never be max)
</span>        <span class="k">while</span> <span class="n">dq</span> <span class="ow">and</span> <span class="n">nums</span><span class="p">[</span><span class="n">dq</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">&lt;</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">dq</span><span class="p">.</span><span class="nf">pop</span><span class="p">()</span>
        
        <span class="c1"># Add current index
</span>        <span class="n">dq</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        
        <span class="c1"># Add to result if window is complete
</span>        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">result</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="n">dq</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
    
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></div>

<p><strong>Complexity:</strong></p>
<ul>
  <li><strong>Time:</strong> $O(n)$. Each element is added and removed at most once.</li>
  <li><strong>Space:</strong> $O(k)$ for the deque.</li>
</ul>

<h2 id="5-detailed-walkthrough">5. Detailed Walkthrough</h2>

<p><strong>Example:</strong> <code class="language-plaintext highlighter-rouge">nums = [1,3,-1,-3,5,3,6,7]</code>, <code class="language-plaintext highlighter-rouge">k = 3</code></p>

<table>
  <thead>
    <tr>
      <th>i</th>
      <th>nums[i]</th>
      <th>Deque (indices)</th>
      <th>Deque (values)</th>
      <th>Window Max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1</td>
      <td>[0]</td>
      <td>[1]</td>
      <td>-</td>
    </tr>
    <tr>
      <td>1</td>
      <td>3</td>
      <td>[1]</td>
      <td>[3]</td>
      <td>-</td>
    </tr>
    <tr>
      <td>2</td>
      <td>-1</td>
      <td>[1, 2]</td>
      <td>[3, -1]</td>
      <td>3</td>
    </tr>
    <tr>
      <td>3</td>
      <td>-3</td>
      <td>[1, 2, 3]</td>
      <td>[3, -1, -3]</td>
      <td>3</td>
    </tr>
    <tr>
      <td>4</td>
      <td>5</td>
      <td>[4]</td>
      <td>[5]</td>
      <td>5</td>
    </tr>
    <tr>
      <td>5</td>
      <td>3</td>
      <td>[4, 5]</td>
      <td>[5, 3]</td>
      <td>5</td>
    </tr>
    <tr>
      <td>6</td>
      <td>6</td>
      <td>[6]</td>
      <td>[6]</td>
      <td>6</td>
    </tr>
    <tr>
      <td>7</td>
      <td>7</td>
      <td>[7]</td>
      <td>[7]</td>
      <td>7</td>
    </tr>
  </tbody>
</table>

<p><strong>Observations:</strong></p>
<ul>
  <li>At i=1: 3 &gt; 1, so we remove index 0.</li>
  <li>At i=4: 5 &gt; -3, -1, 3, so we remove all and start fresh.</li>
  <li>The front of the deque always has the maximum.</li>
</ul>

<h2 id="6-why-monotonic-deque-works">6. Why Monotonic Deque Works</h2>

<p><strong>Invariant:</strong> The deque is always:</p>
<ol>
  <li><strong>Sorted by index:</strong> Indices are in increasing order.</li>
  <li><strong>Sorted by value:</strong> Values are in decreasing order.</li>
</ol>

<p><strong>Key Property:</strong> If we see a larger element, all smaller preceding elements become irrelevant—they can never be the max for any future window.</p>

<p><strong>Amortized Analysis:</strong> Each element is pushed once and popped at most once. Total operations = $O(2n) = O(n)$.</p>

<h2 id="7-approach-3-segment-tree">7. Approach 3: Segment Tree</h2>

<p><strong>Build a segment tree for range maximum queries.</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">SegmentTree</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">arr</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">n</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">tree</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">self</span><span class="p">.</span><span class="n">n</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="nf">build</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">start</span> <span class="o">==</span> <span class="n">end</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">tree</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">start</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">start</span> <span class="o">+</span> <span class="n">end</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">build</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">node</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">mid</span><span class="p">)</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">build</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">node</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
            <span class="n">self</span><span class="p">.</span><span class="n">tree</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="nf">max</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">tree</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">node</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">self</span><span class="p">.</span><span class="n">tree</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">node</span><span class="o">+</span><span class="mi">2</span><span class="p">])</span>
    
    <span class="k">def</span> <span class="nf">query</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="n">start</span> <span class="ow">or</span> <span class="n">l</span> <span class="o">&gt;</span> <span class="n">end</span><span class="p">:</span>
            <span class="k">return</span> <span class="nf">float</span><span class="p">(</span><span class="sh">'</span><span class="s">-inf</span><span class="sh">'</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">l</span> <span class="o">&lt;=</span> <span class="n">start</span> <span class="ow">and</span> <span class="n">end</span> <span class="o">&lt;=</span> <span class="n">r</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">tree</span><span class="p">[</span><span class="n">node</span><span class="p">]</span>
        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">start</span> <span class="o">+</span> <span class="n">end</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="k">return</span> <span class="nf">max</span><span class="p">(</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">query</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">node</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">),</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">query</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">node</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
        <span class="p">)</span>

<span class="k">def</span> <span class="nf">maxSlidingWindow</span><span class="p">(</span><span class="n">nums</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="n">st</span> <span class="o">=</span> <span class="nc">SegmentTree</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span> <span class="o">-</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">result</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">st</span><span class="p">.</span><span class="nf">query</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></div>

<p><strong>Complexity:</strong></p>
<ul>
  <li><strong>Time:</strong> $O(n \log n)$ (build) + $O((n-k+1) \log n)$ (queries).</li>
  <li><strong>Space:</strong> $O(n)$ for the tree.</li>
</ul>

<p><strong>When to use:</strong> When you need both range max and point updates.</p>

<h2 id="8-approach-4-sparse-table-static">8. Approach 4: Sparse Table (Static)</h2>

<p>For static arrays, sparse table gives $O(1)$ range max queries.</p>

<p><strong>Build:</strong> $O(n \log n)$.
<strong>Query:</strong> $O(1)$.</p>

<p><strong>Trade-off:</strong> No updates possible.</p>

<h2 id="9-extension-sliding-window-minimum">9. Extension: Sliding Window Minimum</h2>

<p>Same algorithm, just reverse the comparison:</p>
<ul>
  <li>Remove elements <strong>larger</strong> than current (instead of smaller).</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">minSlidingWindow</span><span class="p">(</span><span class="n">nums</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="n">dq</span> <span class="o">=</span> <span class="nf">deque</span><span class="p">()</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)):</span>
        <span class="k">while</span> <span class="n">dq</span> <span class="ow">and</span> <span class="n">dq</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">i</span> <span class="o">-</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">dq</span><span class="p">.</span><span class="nf">popleft</span><span class="p">()</span>
        
        <span class="k">while</span> <span class="n">dq</span> <span class="ow">and</span> <span class="n">nums</span><span class="p">[</span><span class="n">dq</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">&gt;</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>  <span class="c1"># Changed comparison
</span>            <span class="n">dq</span><span class="p">.</span><span class="nf">pop</span><span class="p">()</span>
        
        <span class="n">dq</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">result</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="n">dq</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
    
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></div>

<h2 id="10-related-problem-shortest-subarray-with-sum-at-least-k">10. Related Problem: Shortest Subarray with Sum at Least K</h2>

<p><strong>Problem (LeetCode 862):</strong> Find the shortest subarray with sum ≥ K (can have negative numbers).</p>

<p><strong>Approach:</strong> Use monotonic deque on prefix sums.</p>

<p><strong>Key Insight:</strong> For prefix sum array <code class="language-plaintext highlighter-rouge">P</code>:</p>
<ul>
  <li>We want shortest <code class="language-plaintext highlighter-rouge">j - i</code> where <code class="language-plaintext highlighter-rouge">P[j] - P[i] &gt;= K</code>.</li>
  <li>Deque stores indices in increasing order of <code class="language-plaintext highlighter-rouge">P[i]</code>.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">collections</span> <span class="kn">import</span> <span class="n">deque</span>

<span class="k">def</span> <span class="nf">shortestSubarray</span><span class="p">(</span><span class="n">nums</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">prefix</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">prefix</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    
    <span class="n">dq</span> <span class="o">=</span> <span class="nf">deque</span><span class="p">()</span>
    <span class="n">result</span> <span class="o">=</span> <span class="nf">float</span><span class="p">(</span><span class="sh">'</span><span class="s">inf</span><span class="sh">'</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="c1"># Check if we can form a valid subarray
</span>        <span class="k">while</span> <span class="n">dq</span> <span class="ow">and</span> <span class="n">prefix</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">prefix</span><span class="p">[</span><span class="n">dq</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">&gt;=</span> <span class="n">k</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="nf">min</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">i</span> <span class="o">-</span> <span class="n">dq</span><span class="p">.</span><span class="nf">popleft</span><span class="p">())</span>
        
        <span class="c1"># Maintain monotonicity
</span>        <span class="k">while</span> <span class="n">dq</span> <span class="ow">and</span> <span class="n">prefix</span><span class="p">[</span><span class="n">dq</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">&gt;=</span> <span class="n">prefix</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">dq</span><span class="p">.</span><span class="nf">pop</span><span class="p">()</span>
        
        <span class="n">dq</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">result</span> <span class="k">if</span> <span class="n">result</span> <span class="o">!=</span> <span class="nf">float</span><span class="p">(</span><span class="sh">'</span><span class="s">inf</span><span class="sh">'</span><span class="p">)</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
</code></pre></div></div>

<h2 id="11-system-design-real-time-analytics">11. System Design: Real-Time Analytics</h2>

<p><strong>Scenario:</strong> Compute the maximum value in the last 5 minutes from a stream of events.</p>

<p><strong>Architecture:</strong></p>
<ol>
  <li>Events arrive as (timestamp, value).</li>
  <li>Maintain a deque of (timestamp, value).</li>
  <li>On each event:
    <ul>
      <li>Remove events older than 5 minutes.</li>
      <li>Remove smaller values (they’ll never be max).</li>
      <li>Add new event.</li>
    </ul>
  </li>
  <li>Query: Return the front of the deque.</li>
</ol>

<p><strong>Use Cases:</strong></p>
<ul>
  <li>Max stock price in last N minutes.</li>
  <li>Peak CPU usage in a time window.</li>
  <li>Highest bid in an auction window.</li>
</ul>

<h2 id="12-interview-questions">12. Interview Questions</h2>

<ol>
  <li><strong>Sliding Window Maximum (Classic):</strong> Solve with monotonic deque.</li>
  <li><strong>Sliding Window Minimum:</strong> Variant with min instead of max.</li>
  <li><strong>Shortest Subarray with Sum ≥ K:</strong> Prefix sums + deque.</li>
  <li><strong>Jump Game VI:</strong> DP + monotonic deque.</li>
  <li><strong>Constrained Subsequence Sum:</strong> DP + deque optimization.</li>
</ol>

<h2 id="13-common-mistakes">13. Common Mistakes</h2>

<ul>
  <li><strong>Off-by-One:</strong> Window starts at index <code class="language-plaintext highlighter-rouge">k-1</code>, not <code class="language-plaintext highlighter-rouge">k</code>.</li>
  <li><strong>Using Values Instead of Indices:</strong> Store indices to check window boundaries.</li>
  <li><strong>Wrong Removal Order:</strong> Remove from front for window bounds, from back for monotonicity.</li>
  <li><strong>Forgetting to Add Current Element:</strong> Always append to deque.</li>
  <li><strong>Edge Cases:</strong> k = 1, k = n.</li>
</ul>

<h2 id="14-variant-count-elements-greater-than-x-in-each-window">14. Variant: Count Elements Greater Than X in Each Window</h2>

<p><strong>Problem:</strong> For each window, count elements &gt; X.</p>

<p><strong>Approach:</strong></p>
<ol>
  <li>Preprocess: Create array where <code class="language-plaintext highlighter-rouge">a[i] = 1 if nums[i] &gt; X else 0</code>.</li>
  <li>Use sliding window sum (prefix sum or two pointers).</li>
</ol>

<h2 id="15-variant-median-of-sliding-window">15. Variant: Median of Sliding Window</h2>

<p><strong>Problem:</strong> Find the median of each window.</p>

<p><strong>Approach:</strong></p>
<ul>
  <li>Two heaps (like streaming median).</li>
  <li>SortedList for O(log k) insertions/deletions.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">sortedcontainers</span> <span class="kn">import</span> <span class="n">SortedList</span>

<span class="k">def</span> <span class="nf">medianSlidingWindow</span><span class="p">(</span><span class="n">nums</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="n">window</span> <span class="o">=</span> <span class="nc">SortedList</span><span class="p">()</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">num</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">nums</span><span class="p">):</span>
        <span class="n">window</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">window</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">k</span><span class="p">:</span>
            <span class="n">window</span><span class="p">.</span><span class="nf">remove</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">k</span><span class="p">])</span>
        
        <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">window</span><span class="p">)</span> <span class="o">==</span> <span class="n">k</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">result</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">window</span><span class="p">[</span><span class="n">k</span> <span class="o">//</span> <span class="mi">2</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span><span class="p">.</span><span class="nf">append</span><span class="p">((</span><span class="n">window</span><span class="p">[</span><span class="n">k</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">window</span><span class="p">[</span><span class="n">k</span> <span class="o">//</span> <span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></div>

<h2 id="16-performance-comparison">16. Performance Comparison</h2>

<table>
  <thead>
    <tr>
      <th>Approach</th>
      <th>Time</th>
      <th>Space</th>
      <th>Use Case</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Brute Force</td>
      <td>$O(n \cdot k)$</td>
      <td>$O(1)$</td>
      <td>Small k</td>
    </tr>
    <tr>
      <td>Monotonic Deque</td>
      <td>$O(n)$</td>
      <td>$O(k)$</td>
      <td>General (optimal)</td>
    </tr>
    <tr>
      <td>Segment Tree</td>
      <td>$O(n \log n)$</td>
      <td>$O(n)$</td>
      <td>Range queries + updates</td>
    </tr>
    <tr>
      <td>Sparse Table</td>
      <td>$O(n \log n)$ build, $O(1)$ query</td>
      <td>$O(n \log n)$</td>
      <td>Static arrays</td>
    </tr>
  </tbody>
</table>

<h2 id="17-deep-dive-deque-implementation">17. Deep Dive: Deque Implementation</h2>

<p><strong>Python <code class="language-plaintext highlighter-rouge">collections.deque</code>:</strong></p>
<ul>
  <li>Doubly-linked list implementation.</li>
  <li>O(1) append/pop from both ends.</li>
  <li>Thread-safe for single operations.</li>
</ul>

<p><strong>Java <code class="language-plaintext highlighter-rouge">ArrayDeque</code>:</strong></p>
<ul>
  <li>Circular array implementation.</li>
  <li>O(1) amortized for all operations.</li>
  <li>More cache-friendly than linked list.</li>
</ul>

<h2 id="18-application-stock-price-analysis">18. Application: Stock Price Analysis</h2>

<p><strong>Scenario:</strong> Find the maximum stock price in each trading window.</p>

<p><strong>Requirements:</strong></p>
<ul>
  <li>Support add new price.</li>
  <li>Support query max in last k prices.</li>
  <li>Support remove old prices.</li>
</ul>

<p><strong>Implementation:</strong></p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">StockAnalyzer</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">window_size</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">k</span> <span class="o">=</span> <span class="n">window_size</span>
        <span class="n">self</span><span class="p">.</span><span class="n">prices</span> <span class="o">=</span> <span class="nf">deque</span><span class="p">()</span>
        <span class="n">self</span><span class="p">.</span><span class="n">max_deque</span> <span class="o">=</span> <span class="nf">deque</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">add_price</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">price</span><span class="p">):</span>
        <span class="c1"># Remove old prices
</span>        <span class="k">while</span> <span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">prices</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">self</span><span class="p">.</span><span class="n">k</span><span class="p">:</span>
            <span class="n">old</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">prices</span><span class="p">.</span><span class="nf">popleft</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">max_deque</span> <span class="ow">and</span> <span class="n">self</span><span class="p">.</span><span class="n">max_deque</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">old</span><span class="p">:</span>
                <span class="n">self</span><span class="p">.</span><span class="n">max_deque</span><span class="p">.</span><span class="nf">popleft</span><span class="p">()</span>
        
        <span class="c1"># Maintain monotonicity
</span>        <span class="k">while</span> <span class="n">self</span><span class="p">.</span><span class="n">max_deque</span> <span class="ow">and</span> <span class="n">self</span><span class="p">.</span><span class="n">max_deque</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">price</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">max_deque</span><span class="p">.</span><span class="nf">pop</span><span class="p">()</span>
        
        <span class="n">self</span><span class="p">.</span><span class="n">prices</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">price</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">max_deque</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">price</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">get_max</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">max_deque</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">max_deque</span> <span class="k">else</span> <span class="bp">None</span>
</code></pre></div></div>

<h2 id="19-conclusion">19. Conclusion</h2>

<p>Sliding Window Maximum is a classic problem that teaches the power of monotonic data structures. The key insight is that we only need to track “useful” elements—those that could potentially be the maximum.</p>

<p><strong>Key Takeaways:</strong></p>
<ul>
  <li><strong>Monotonic Deque:</strong> O(n) solution, O(k) space.</li>
  <li><strong>Invariant:</strong> Deque is sorted by both index and value.</li>
  <li><strong>Amortized Analysis:</strong> Each element pushed/popped once.</li>
  <li><strong>Extensions:</strong> Min, sum ≥ K, median.</li>
</ul>

<p>This pattern appears frequently in interview problems. Master it, and you’ll recognize it in many disguises.</p>

<h2 id="20-mastery-checklist">20. Mastery Checklist</h2>

<p><strong>Mastery Checklist:</strong></p>
<ul class="task-list">
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Implement brute force O(nk) solution</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Implement monotonic deque O(n) solution</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Explain why elements are removed</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Solve sliding window minimum variant</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Solve Shortest Subarray with Sum ≥ K</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Implement with segment tree</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Handle edge cases (k=1, k=n)</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Apply to real-time analytics</li>
</ul>

<h2 id="21-advanced-application-jump-game-vi">21. Advanced Application: Jump Game VI</h2>

<p><strong>Problem (LeetCode 1696):</strong> Given array <code class="language-plaintext highlighter-rouge">nums</code> and integer <code class="language-plaintext highlighter-rouge">k</code>, start at index 0. From index <code class="language-plaintext highlighter-rouge">i</code>, you can jump to any index in <code class="language-plaintext highlighter-rouge">[i+1, min(i+k, n-1)]</code>. Score = sum of values at visited indices. Find maximum score to reach the last index.</p>

<p><strong>DP Recurrence:</strong>
\(dp[i] = nums[i] + \max_{j=\max(0,i-k)}^{i-1} dp[j]\)</p>

<p><strong>Naive:</strong> $O(n \cdot k)$.</p>

<p><strong>Optimized with Monotonic Deque:</strong> $O(n)$.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">collections</span> <span class="kn">import</span> <span class="n">deque</span>

<span class="k">def</span> <span class="nf">maxResult</span><span class="p">(</span><span class="n">nums</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>
    <span class="n">dp</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>
    <span class="n">dp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="n">dq</span> <span class="o">=</span> <span class="nf">deque</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># Stores indices with max dp values
</span>    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="c1"># Remove out-of-window indices
</span>        <span class="k">while</span> <span class="n">dq</span> <span class="ow">and</span> <span class="n">dq</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">i</span> <span class="o">-</span> <span class="n">k</span><span class="p">:</span>
            <span class="n">dq</span><span class="p">.</span><span class="nf">popleft</span><span class="p">()</span>
        
        <span class="c1"># dp[i] = nums[i] + max dp in window
</span>        <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dp</span><span class="p">[</span><span class="n">dq</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        
        <span class="c1"># Maintain monotonicity (max deque)
</span>        <span class="k">while</span> <span class="n">dq</span> <span class="ow">and</span> <span class="n">dp</span><span class="p">[</span><span class="n">dq</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">&lt;=</span> <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">dq</span><span class="p">.</span><span class="nf">pop</span><span class="p">()</span>
        
        <span class="n">dq</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">dp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div></div>

<h2 id="22-advanced-application-constrained-subsequence-sum">22. Advanced Application: Constrained Subsequence Sum</h2>

<p><strong>Problem (LeetCode 1425):</strong> Find maximum sum of a subsequence where consecutive elements are at most <code class="language-plaintext highlighter-rouge">k</code> indices apart.</p>

<p><strong>Same pattern:</strong> DP + monotonic deque.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">constrainedSubsetSum</span><span class="p">(</span><span class="n">nums</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>
    <span class="n">dp</span> <span class="o">=</span> <span class="n">nums</span><span class="p">.</span><span class="nf">copy</span><span class="p">()</span>
    <span class="n">dq</span> <span class="o">=</span> <span class="nf">deque</span><span class="p">()</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">dq</span><span class="p">:</span>
            <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nf">max</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dp</span><span class="p">[</span><span class="n">dq</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
        
        <span class="k">while</span> <span class="n">dq</span> <span class="ow">and</span> <span class="n">dp</span><span class="p">[</span><span class="n">dq</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">&lt;=</span> <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">dq</span><span class="p">.</span><span class="nf">pop</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Only add positive contributions
</span>            <span class="n">dq</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        
        <span class="k">while</span> <span class="n">dq</span> <span class="ow">and</span> <span class="n">dq</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">k</span><span class="p">:</span>
            <span class="n">dq</span><span class="p">.</span><span class="nf">popleft</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="nf">max</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="23-pattern-recognition">23. Pattern Recognition</h2>

<p><strong>When to use Monotonic Deque:</strong></p>
<ol>
  <li><strong>Sliding window problems</strong> with max/min queries.</li>
  <li><strong>DP optimization</strong> where state transition involves max/min over a range.</li>
  <li><strong>Range queries</strong> with fixed window size.</li>
</ol>

<p><strong>Key Questions:</strong></p>
<ul>
  <li>Do I need max/min of a sliding range?</li>
  <li>Is the range size fixed or bounded?</li>
  <li>Can I remove elements that will never be useful?</li>
</ul>

<h2 id="24-implementation-variants">24. Implementation Variants</h2>

<h3 id="241-using-tuple-value-index">24.1. Using Tuple (Value, Index)</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">maxSlidingWindow</span><span class="p">(</span><span class="n">nums</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="n">dq</span> <span class="o">=</span> <span class="nf">deque</span><span class="p">()</span>  <span class="c1"># (value, index)
</span>    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">num</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">nums</span><span class="p">):</span>
        <span class="k">while</span> <span class="n">dq</span> <span class="ow">and</span> <span class="n">dq</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">k</span><span class="p">:</span>
            <span class="n">dq</span><span class="p">.</span><span class="nf">popleft</span><span class="p">()</span>
        
        <span class="k">while</span> <span class="n">dq</span> <span class="ow">and</span> <span class="n">dq</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">num</span><span class="p">:</span>
            <span class="n">dq</span><span class="p">.</span><span class="nf">pop</span><span class="p">()</span>
        
        <span class="n">dq</span><span class="p">.</span><span class="nf">append</span><span class="p">((</span><span class="n">num</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
        
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">result</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">dq</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
    
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></div>

<h3 id="242-max-heap-with-lazy-deletion">24.2. Max-Heap with Lazy Deletion</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">heapq</span>

<span class="k">def</span> <span class="nf">maxSlidingWindow</span><span class="p">(</span><span class="n">nums</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="n">heap</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Max-heap: (-value, index)
</span>    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">num</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">nums</span><span class="p">):</span>
        <span class="n">heapq</span><span class="p">.</span><span class="nf">heappush</span><span class="p">(</span><span class="n">heap</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="n">num</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
        
        <span class="c1"># Remove out-of-window elements
</span>        <span class="k">while</span> <span class="n">heap</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">k</span><span class="p">:</span>
            <span class="n">heapq</span><span class="p">.</span><span class="nf">heappop</span><span class="p">(</span><span class="n">heap</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">result</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="o">-</span><span class="n">heap</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
    
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></div>

<p><strong>Complexity:</strong> $O(n \log n)$ due to lazy deletion.</p>

<h2 id="25-testing-strategy">25. Testing Strategy</h2>

<p><strong>Test Cases:</strong></p>
<ol>
  <li><strong>Basic:</strong> <code class="language-plaintext highlighter-rouge">[1,3,-1,-3,5,3,6,7], k=3</code> → <code class="language-plaintext highlighter-rouge">[3,3,5,5,6,7]</code>.</li>
  <li><strong>All Same:</strong> <code class="language-plaintext highlighter-rouge">[5,5,5,5], k=2</code> → <code class="language-plaintext highlighter-rouge">[5,5,5]</code>.</li>
  <li><strong>Increasing:</strong> <code class="language-plaintext highlighter-rouge">[1,2,3,4,5], k=3</code> → <code class="language-plaintext highlighter-rouge">[3,4,5]</code>.</li>
  <li><strong>Decreasing:</strong> <code class="language-plaintext highlighter-rouge">[5,4,3,2,1], k=3</code> → <code class="language-plaintext highlighter-rouge">[5,4,3]</code>.</li>
  <li><strong>k=1:</strong> <code class="language-plaintext highlighter-rouge">[1,2,3], k=1</code> → <code class="language-plaintext highlighter-rouge">[1,2,3]</code>.</li>
  <li><strong>k=n:</strong> <code class="language-plaintext highlighter-rouge">[1,2,3], k=3</code> → <code class="language-plaintext highlighter-rouge">[3]</code>.</li>
  <li><strong>Negative Numbers:</strong> <code class="language-plaintext highlighter-rouge">[-1,-3,-2,-4], k=2</code> → <code class="language-plaintext highlighter-rouge">[-1,-2,-2]</code>.</li>
</ol>

<h2 id="26-complexity-deep-dive">26. Complexity Deep Dive</h2>

<p><strong>Time Complexity Proof:</strong></p>

<p>Each element:</p>
<ul>
  <li>Enters the deque once: $O(n)$ total.</li>
  <li>Exits the deque at most once: $O(n)$ total.</li>
</ul>

<p>Therefore, total operations = $O(2n) = O(n)$.</p>

<p><strong>Space Complexity:</strong></p>

<p>Deque stores at most <code class="language-plaintext highlighter-rouge">k</code> elements (window size).</p>

<p>Space = $O(k)$.</p>

<h2 id="27-related-leetcode-problems">27. Related LeetCode Problems</h2>

<ul>
  <li><strong>LC 239:</strong> Sliding Window Maximum (this problem).</li>
  <li><strong>LC 862:</strong> Shortest Subarray with Sum at Least K.</li>
  <li><strong>LC 1696:</strong> Jump Game VI.</li>
  <li><strong>LC 1425:</strong> Constrained Subsequence Sum.</li>
  <li><strong>LC 480:</strong> Sliding Window Median.</li>
  <li><strong>LC 1438:</strong> Longest Continuous Subarray with Abs Diff ≤ Limit.</li>
</ul>

<h2 id="28-conclusion">28. Conclusion</h2>

<p>Sliding Window Maximum is a gateway to understanding monotonic data structures. The deque-based solution is elegant and efficient, demonstrating how maintaining invariants can lead to optimal algorithms.</p>

<p><strong>Key Insights:</strong></p>
<ol>
  <li><strong>Monotonic Invariant:</strong> Elements in decreasing order of value.</li>
  <li><strong>Amortized O(n):</strong> Each element pushed/popped once.</li>
  <li><strong>Template:</strong> The pattern applies to many DP optimizations.</li>
  <li><strong>Real-World:</strong> Stock analysis, sensor monitoring, network analytics.</li>
</ol>

<p>Once you internalize this pattern, you’ll see opportunities to apply it everywhere. It’s one of the most versatile techniques in the algorithmic toolbox.</p>

<p><strong>Practice Challenge:</strong> Implement sliding window maximum without using any library data structures (raw arrays only). This deepens understanding of the underlying mechanics.</p>


        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#array" class="page__taxonomy-item p-category" rel="tag">array</a><span class="sep">, </span>
    
      <a href="/tags/#deque" class="page__taxonomy-item p-category" rel="tag">deque</a><span class="sep">, </span>
    
      <a href="/tags/#monotonic-deque" class="page__taxonomy-item p-category" rel="tag">monotonic-deque</a><span class="sep">, </span>
    
      <a href="/tags/#sliding-window" class="page__taxonomy-item p-category" rel="tag">sliding-window</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#dsa" class="page__taxonomy-item p-category" rel="tag">dsa</a>
    
    </span>
  </p>


        
      </footer>

      

      <section class="page__share">
  <h4 class="page__share-title">Share on</h4>

  <a href="https://twitter.com/intent/tweet?via=arunbaby0&text=Sliding+Window+Maximum%20https%3A%2F%2Fwww.arunbaby.com%2Fdsa%2F0045-sliding-window-maximum%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.arunbaby.com%2Fdsa%2F0045-sliding-window-maximum%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.arunbaby.com/dsa/0045-sliding-window-maximum/" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/dsa/0044-largest-rectangle-histogram/" class="pagination--pager" title="Largest Rectangle in Histogram">Previous</a>
    
    
      <a href="#" class="pagination--pager disabled">Next</a>
    
  </nav>


    </div>

    
  </article>

  
  
</div>

      
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://twitter.com/arunbaby0" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://github.com/arunbaby0" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
          <li><a href="https://www.linkedin.com/in/arunbaby0/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
        
      
        
          <li><a href="https://scholar.google.co.in/citations?user=6fSYWhkAAAAJ" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-graduation-cap" aria-hidden="true"></i> Google Scholar</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 1990 - 2143 <a href="https://www.arunbaby.com">Arun Baby</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0JRJPEC9SS"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-0JRJPEC9SS', { 'anonymize_ip': false});
</script>








  </body>
</html>
